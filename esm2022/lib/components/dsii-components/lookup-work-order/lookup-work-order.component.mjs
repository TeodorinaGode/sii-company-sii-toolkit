import { Component, forwardRef, Input } from '@angular/core';
import { UntypedFormControl, NG_VALIDATORS, NG_VALUE_ACCESSOR, FormsModule, ReactiveFormsModule } from '@angular/forms';
import { MatAutocompleteTrigger, MatAutocomplete } from '@angular/material/autocomplete';
import { merge, Subject } from 'rxjs';
import { debounceTime, distinctUntilChanged, filter, map, startWith, switchMap, tap } from 'rxjs/operators';
import { SearchWorkOrderDialogComponent } from './components/search-work-order-dialog/search-work-order-dialog.component';
import { MatFormField, MatLabel, MatHint, MatSuffix } from '@angular/material/form-field';
import { MatProgressBar } from '@angular/material/progress-bar';
import { MatIcon } from '@angular/material/icon';
import { MatTooltip } from '@angular/material/tooltip';
import { MatOptgroup, MatOption } from '@angular/material/core';
import { MatInput } from '@angular/material/input';
import { NgClass, AsyncPipe } from '@angular/common';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "@angular/material/dialog";
import * as i3 from "../../../sii-toolkit.service";
import * as i4 from "@angular/forms";
export class LookupWorkOrderComponent {
    ngOnInit() {
        // this.checkSubSystemValue();
    }
    constructor(http, dialog, siiToolkitService) {
        this.http = http;
        this.dialog = dialog;
        this.siiToolkitService = siiToolkitService;
        this.hideCdc = false;
        this.hideIO = false;
        this.hideSS = false;
        this.appearance = 'outline';
        this.required = false;
        this.disabled = false;
        this.defaultComSS = { comSS: 'AA01', comSSDescription: 'AA01' };
        this.lookupInternalOrderComponentCtrl = new UntypedFormControl();
        this.lookupSubSystemComponentCtrl = new UntypedFormControl();
        this.subSystemData = [];
        this.subjectSubSystemDataChange = new Subject();
        this.subjectOnChange = new Subject();
        this.selectedItem = {};
        this.utils = {
            subsystemLoadingInProgress: false,
            ioLoadingInProgress: false,
            cdcLoadingInProgress: false,
            internalOrderValid: true,
            subSystemValid: true,
            forceSearch: 0,
        };
        this.propagateChange = () => { };
        this.onTouchedCallback = () => { };
        this.validatorCallback = () => { };
        // ricerco le commessa in base al valore inserito nel campo di input
        this.internalOrderRestObs = this.getcommCdcInputValueChangeObserver()
            .pipe(tap((res) => this.utils.ioLoadingInProgress = true), 
        // switchMap((val) => this.getIODataFromServer(val)),
        switchMap((val) => this.getIODataFromServer(val)), tap((res) => this.utils.ioLoadingInProgress = false));
        // ricerco i cdc in base al valore inserito nel campo di input
        this.cdcRestObs = this.getcommCdcInputValueChangeObserver()
            .pipe(tap((res) => this.utils.cdcLoadingInProgress = true), switchMap((val) => this.getCDCDataFromServer(val)), tap((res) => this.utils.cdcLoadingInProgress = false));
        // ricerco i sottosistemi in base al valore inserito nel campo di input o al cambiamento di commessa/cdc
        this.subSystemDataObs = merge(this.lookupSubSystemComponentCtrl.valueChanges, this.subjectSubSystemDataChange)
            .pipe(startWith(null), tap((text) => { if (typeof text === 'string') {
            this.comSSChange({ comSS: text, comSSDescription: text }, false);
        } }), filter((text) => text == null || typeof text === 'string'), map((txt) => {
            return txt ? this._filterSubSystem(txt) : this.subSystemData.slice();
        }));
        this.subjectOnChange.pipe(debounceTime(500)).subscribe(() => this.onChange());
    }
    ngOnChanges(changes) {
        if (changes.refresh && this.refresh != null) {
            this.refresh.subscribe((ioCdcText) => {
                this.utils.forceSearch = 2;
                this.lookupInternalOrderComponentCtrl.setValue(ioCdcText);
            });
        }
    }
    getcommCdcInputValueChangeObserver() {
        return this.lookupInternalOrderComponentCtrl.valueChanges
            .pipe(tap((text) => { if (typeof text === 'string') {
            this.ioCdcChange(null);
            this.comSSChange(null);
        } }), filter((text) => typeof text === 'string' && (!!this.utils.forceSearch || text.length > 2)), debounceTime(500), distinctUntilChanged((a, b) => { return a === b && !this.utils.forceSearch; }), tap(() => this.utils.forceSearch--));
    }
    displayFn(intOrd) {
        return intOrd ? intOrd.itemId : undefined;
    }
    displayComSSFn(intOrd) {
        return intOrd ? intOrd.comSS : undefined;
    }
    // selezione di comSS dall'autocomplete
    onComSSSelectionChanged(event) {
        this.comSSChange(event.option.value, false);
    }
    comSSChange(comSS, updateInputValue = true) {
        this.selectedItem.comSS = comSS != null ? comSS.comSS : null;
        this.selectedItem.comSSDescrizione = comSS != null ? comSS.comSSDescription : null;
        this.selectedItem.comSSDescrizione = comSS != null ? comSS.comSSDescription : null;
        if (updateInputValue) {
            this.updateSubSystemComponentValue();
        }
        this.subjectOnChange.next();
    }
    ioCdcChange(item) {
        this.selectedItem.commessa = item != null ? item.itemId : null;
        this.selectedItem.commessaDescrizione = item != null ? item.itemDescription : null;
        this.selectedItem.type = item != null ? item.type : null;
        this.selectedItem._dbData = item;
        this.subjectOnChange.next();
        if (!this.hideSS) {
            this.loadSubSystem();
        }
    }
    onSelectionChanged(event) {
        this.ioCdcChange(event.option.value);
    }
    loadSubSystem() {
        this.subSystemData = [];
        this.subjectSubSystemDataChange.next();
        if (this.selectedItem != null && this.selectedItem.commessa != null) {
            this.utils.subsystemLoadingInProgress = true;
            this.http.get(`${this.siiToolkitService.environment.domain}/lookup/comSS?internalOrder=${encodeURIComponent(this.selectedItem.commessa)}`)
                .subscribe((res) => {
                this.subSystemData = res;
                this.comSSChange(res.length > 0 ? res[0] : this.defaultComSS);
                this.subjectSubSystemDataChange.next();
                this.utils.subsystemLoadingInProgress = false;
            });
        }
    }
    checkEnableComSS() {
        // tslint:disable-next-line:max-line-length
        const itemValueValidAndEnabled = this.selectedItem != null && this.selectedItem.commessa != null && this.lookupInternalOrderComponentCtrl.enabled;
        if (itemValueValidAndEnabled && this.lookupSubSystemComponentCtrl.disabled) {
            this.lookupSubSystemComponentCtrl.enable();
        }
        else if (!itemValueValidAndEnabled && this.lookupSubSystemComponentCtrl.enabled) {
            this.lookupSubSystemComponentCtrl.disable();
        }
    }
    _filterSubSystem(value) {
        const filterValue = value.toLowerCase();
        return this.subSystemData.filter((val) => val.comSS.toLowerCase().indexOf(filterValue) === 0);
    }
    getIODataFromServer(txt) {
        return (this.customIORestFunct === undefined ? this.useIODefaultRestObs(txt) : this.customIORestFunct(txt))
            .pipe(map(x => { x.forEach(i => i.type = 'IO'); return x; }));
    }
    getCDCDataFromServer(txt) {
        return (this.customCDCRestFunct === undefined ? this.useCDCDefaultRestObs(txt) : this.customCDCRestFunct(txt))
            .pipe(map(x => { x.forEach(i => i.type = 'CDC'); return x; }));
        ;
    }
    useIODefaultRestObs(txt) {
        return this.http.post(`${this.siiToolkitService.environment.domain}/lookup/internal_order/simple`, {
            text: txt,
            codSociety: this.codSociety,
        });
    }
    useCDCDefaultRestObs(txt) {
        return this.http.post(`${this.siiToolkitService.environment.domain}/lookup/cdc/simple`, {
            text: txt,
            codSociety: this.codSociety,
        });
    }
    searchPopup() {
        const dialogRef = this.dialog.open(SearchWorkOrderDialogComponent, {
            width: '100vw',
            height: '95%',
            data: {
                codSociety: this.codSociety,
                customPageableIORestFunct: this.customPageableIORestFunct,
                customPageableCdcRestFunct: this.customPageableCDCRestFunct,
                hideCdc: this.hideCdc,
                hideIO: this.hideIO
            },
        });
        dialogRef.afterClosed().subscribe((result) => {
            if (result !== undefined) {
                this.ioCdcChange(result);
                this.updateIOComponentValue();
            }
        });
    }
    updateIOComponentValue() {
        this.lookupInternalOrderComponentCtrl.setValue({
            itemId: this.selectedItem != null ? (this.selectedItem.commessa || '') : '',
            itemDescription: this.selectedItem != null ? (this.selectedItem.commessaDescrizione || '') : '',
        });
    }
    updateSubSystemComponentValue() {
        this.lookupSubSystemComponentCtrl.setValue({
            comSS: this.selectedItem != null ? (this.selectedItem.comSS || '') : '',
            comSSDescription: this.selectedItem != null ? (this.selectedItem.comSSDescrizione || '') : '',
        });
    }
    // metodi per la gestione dell'ngModel
    writeValue(value) {
        this.selectedItem = value;
        this.updateIOComponentValue();
        this.updateSubSystemComponentValue();
        this.checkEnableComSS();
    }
    onChange() {
        // this.onTouchedCallback();
        // console.log(this.selectedItem)
        this.propagateChange(this.selectedItem);
        this.checkEnableComSS();
    }
    registerOnChange(fn) {
        this.propagateChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouchedCallback = fn;
    }
    registerOnValidatorChange(fn) {
        this.validatorCallback = fn;
    }
    // Allows Angular to disable the input.
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        if (this.disabled) {
            this.lookupInternalOrderComponentCtrl.disable();
        }
        else {
            this.lookupInternalOrderComponentCtrl.enable();
        }
        this.checkEnableComSS();
    }
    validate(control) {
        const internalOrderInputValue = this.lookupInternalOrderComponentCtrl.value;
        const respErr = {};
        let iovalid = true;
        let ssValid = true;
        // validazione commessa/cdc
        if (this.required !== false) { // obbligatorio
            if (this.selectedItem == null || this.selectedItem.commessa == null) {
                respErr.required = true;
                iovalid = false;
            }
        }
        else { // non obbligatorio
            if (typeof internalOrderInputValue === 'string' && internalOrderInputValue.trim() !== '') {
                respErr.internalOrderInvalid = true;
                iovalid = false;
            }
        }
        // validazione sottosistema
        if (!this.hideSS) {
            if (this.required !== false) { // obbligatorio
                if (this.selectedItem == null || this.selectedItem.comSS == null || this.selectedItem.comSS.length !== 4) {
                    respErr.subSystemInvalid = true;
                    respErr.subSystemRequired = true;
                    ssValid = false;
                }
            }
            else { // non obbligatorio
                if (this.selectedItem != null && this.selectedItem.comSS != null &&
                    (this.selectedItem.comSS.length > 0 && this.selectedItem.comSS.length !== 4)) {
                    respErr.subSystemInvalid = true;
                    ssValid = false;
                }
            }
        }
        this.utils.internalOrderValid = iovalid;
        this.utils.subSystemValid = ssValid;
        return Object.keys(respErr).length === 0 ? null : respErr;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: LookupWorkOrderComponent, deps: [{ token: i1.HttpClient }, { token: i2.MatDialog }, { token: i3.SiiToolkitService }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.2.13", type: LookupWorkOrderComponent, isStandalone: true, selector: "sii-lookup-work-order", inputs: { label: "label", hideCdc: "hideCdc", hideIO: "hideIO", hideSS: "hideSS", appearance: "appearance", codSociety: "codSociety", required: "required", disabled: "disabled", customIORestFunct: "customIORestFunct", customCDCRestFunct: "customCDCRestFunct", customPageableIORestFunct: "customPageableIORestFunct", customPageableCDCRestFunct: "customPageableCDCRestFunct", refresh: "refresh" }, providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => LookupWorkOrderComponent),
                multi: true,
            },
            { provide: NG_VALIDATORS, useExisting: LookupWorkOrderComponent, multi: true },
        ], usesOnChanges: true, ngImport: i0, template: "<div class=\"lio-mff-container lio-io-cont\" >\r\n  <mat-form-field [appearance]=\"appearance\"  [ngClass]=\"{'lio_fc_invalid': !utils.internalOrderValid}\" >\r\n\r\n    @if(!!label){\r\n      <mat-label>{{label}}</mat-label>\r\n    }\r\n    @else if (!hideIO && !hideCdc) {\r\n        <mat-label i18n=\"@@lookIOCdc_internalorder_cdc\" >Work Order / CDC</mat-label>\r\n      }\r\n    @else if (hideIO) {\r\n        <mat-label i18n=\"@@lookIOCdc_cdc\" >CDC</mat-label>\r\n      }\r\n    @else if (hideCdc) {\r\n        <mat-label i18n=\"@@lookIOCdc_internalorder\" >Work Order</mat-label>\r\n      }\r\n    \r\n\r\n    <input matInput [required]=\"required\"\r\n      aria-label=\"Internal order / cdc\"\r\n      [matAutocomplete]=\"lookupInternalOrderAutocompleteRef\"\r\n      [formControl]=\"lookupInternalOrderComponentCtrl\"  >\r\n      <mat-autocomplete #lookupInternalOrderAutocompleteRef=\"matAutocomplete\"  [displayWith]=\"displayFn\"  class=\"lioAutoComplete\" (optionSelected)=\"onSelectionChanged($event)\">\r\n\r\n        @if (!hideIO) {\r\n          <mat-optgroup label=\"Work Orders\" i18n-label=\"@@lookIOCdc_internalorders\">\r\n            @for (intOrd of internalOrderRestObs | async; track intOrd) {\r\n              <mat-option [value]=\"intOrd\" style=\"border-bottom: 1px solid lightgray;\"\r\n                [matTooltip]=\"intOrd.itemId +' | ' +intOrd.itemDescription\" matTooltipShowDelay=1000>\r\n                <div class=\"lioAutocompleteItems\">\r\n                  <span class=\"lioAutocompleteItemsId\">{{intOrd.itemId}}</span>\r\n                  <span class=\"lioAutocompleteItemsDescr\">{{intOrd.itemDescription}}</span>\r\n                </div>\r\n              </mat-option>\r\n            }\r\n          </mat-optgroup>\r\n        }\r\n\r\n        @if (!hideCdc) {\r\n          <mat-optgroup label=\"CDC\" i18n-label=\"@@lookIOCdc_cdc\">\r\n            @for (intOrd of cdcRestObs | async; track intOrd) {\r\n              <mat-option [value]=\"intOrd\" style=\"border-bottom: 1px solid lightgray;\"\r\n                [matTooltip]=\"intOrd.itemId +' | ' +intOrd.itemDescription\" matTooltipShowDelay=1000>\r\n                <div class=\"lioAutocompleteItems\">\r\n                  <span class=\"lioAutocompleteItemsId\">{{intOrd.itemId}}</span>\r\n                  <span class=\"lioAutocompleteItemsDescr\">{{intOrd.itemDescription}}</span>\r\n                </div>\r\n              </mat-option>\r\n            }\r\n          </mat-optgroup>\r\n        }\r\n      </mat-autocomplete>\r\n\r\n      @if (selectedItem!=undefined) {\r\n        <mat-hint class=\"lioHint\"  [matTooltip]=\"selectedItem.commessaDescrizione\" >{{selectedItem.commessaDescrizione}}</mat-hint>\r\n      }\r\n      <mat-icon [style.visibility]=\"!(disabled!==false) ? 'initial' : 'hidden'\" style=\"cursor: pointer;\" matSuffix (click)=\"searchPopup();$event.stopPropagation();\">search</mat-icon>\r\n    </mat-form-field>\r\n    @if (utils.ioLoadingInProgress || utils.cdcLoadingInProgress) {\r\n      <mat-progress-bar class=\"lioProgressBar\" mode=\"query\"></mat-progress-bar>\r\n    }\r\n  </div>\r\n\r\n\r\n\r\n\r\n  @if(!hideSS){\r\n  <div class=\"lio-mff-container\">\r\n    <mat-form-field [appearance]=\"appearance\"    [ngClass]=\"{'lio_fc_invalid': !utils.subSystemValid}\" >\r\n      <mat-label i18n=\"@@lookIOCdc_subsystem\" >Sub System</mat-label>\r\n      <input matInput [required]=\"required\"\r\n        aria-label=\"Sub System\"\r\n        [matAutocomplete]=\"lookupSubSystemAutocompleteRef\"\r\n        [formControl]=\"lookupSubSystemComponentCtrl\"  >\r\n\r\n        <mat-autocomplete #lookupSubSystemAutocompleteRef=\"matAutocomplete\"    class=\"lioAutoComplete\" [displayWith]=\"displayComSSFn\" (optionSelected)=\"onComSSSelectionChanged($event)\">\r\n          @for (comss of subSystemDataObs | async; track comss) {\r\n            <mat-option [value]=\"comss\"\r\n              [matTooltip]=\"comss.comSS +' | ' +comss.comSSDescription\" matTooltipShowDelay=1000>\r\n              <div class=\"lioAutocompleteItems\">\r\n                <span class=\"lioAutocompleteItemsId\">{{comss.comSS}}</span>\r\n                <span class=\"lioAutocompleteItemsDescr\">{{comss.comSSDescription}}</span>\r\n              </div>\r\n            </mat-option>\r\n          }\r\n        </mat-autocomplete>\r\n        @if (selectedItem!=undefined) {\r\n          <mat-hint class=\"lioHint\"  [matTooltip]=\"selectedItem.comSSDescrizione\" >{{selectedItem.comSSDescrizione}}</mat-hint>\r\n        }\r\n      </mat-form-field>\r\n      @if (utils.subsystemLoadingInProgress) {\r\n        <mat-progress-bar class=\"lioProgressBar\" mode=\"query\"></mat-progress-bar>\r\n      }\r\n    </div>\r\n  }", styles: [":host{display:flex;flex-wrap:wrap}.lioHint{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.lio-io-cont{margin-right:10px}.lioAutocompleteItems{display:flex;flex-direction:column}.lioAutocompleteItems .lioAutocompleteItemsId{line-height:20px}.lioAutocompleteItems .lioAutocompleteItemsDescr{line-height:12px;font-size:10px;max-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}::ng-deep .lioAutoComplete .mat-mdc-option{padding:0 5px!important;border-bottom:1px solid lightgray}::ng-deep .lioAutoComplete .mat-mdc-optgroup-label{background-color:#d3d3d3;text-align:center;font-weight:700;color:#000}.lio_fc_invalid.ng-touched::ng-deep .mdc-notched-outline>*{border-color:red!important}.lio_fc_invalid.ng-touched::ng-deep mat-label{color:red!important}.lio_fc_invalid.ng-touched::ng-deep .mdc-line-ripple:before,.lio_fc_invalid.ng-touched::ng-deep .mdc-line-ripple:after{border-bottom-color:red!important}.lio-mff-container{position:relative;flex:1}.lio-mff-container>mat-form-field{width:100%}.lioProgressBar{height:2px;position:absolute;bottom:16px}\n"], dependencies: [{ kind: "component", type: MatFormField, selector: "mat-form-field", inputs: ["hideRequiredMarker", "color", "floatLabel", "appearance", "subscriptSizing", "hintLabel"], exportAs: ["matFormField"] }, { kind: "directive", type: NgClass, selector: "[ngClass]", inputs: ["class", "ngClass"] }, { kind: "directive", type: MatLabel, selector: "mat-label" }, { kind: "directive", type: MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { kind: "directive", type: MatAutocompleteTrigger, selector: "input[matAutocomplete], textarea[matAutocomplete]", inputs: ["matAutocomplete", "matAutocompletePosition", "matAutocompleteConnectedTo", "autocomplete", "matAutocompleteDisabled"], exportAs: ["matAutocompleteTrigger"] }, { kind: "ngmodule", type: FormsModule }, { kind: "directive", type: i4.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "directive", type: i4.RequiredValidator, selector: ":not([type=checkbox])[required][formControlName],:not([type=checkbox])[required][formControl],:not([type=checkbox])[required][ngModel]", inputs: ["required"] }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i4.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "component", type: MatAutocomplete, selector: "mat-autocomplete", inputs: ["aria-label", "aria-labelledby", "displayWith", "autoActiveFirstOption", "autoSelectActiveOption", "requireSelection", "panelWidth", "disableRipple", "class", "hideSingleSelectionIndicator"], outputs: ["optionSelected", "opened", "closed", "optionActivated"], exportAs: ["matAutocomplete"] }, { kind: "component", type: MatOptgroup, selector: "mat-optgroup", inputs: ["label", "disabled"], exportAs: ["matOptgroup"] }, { kind: "component", type: MatOption, selector: "mat-option", inputs: ["value", "id", "disabled"], outputs: ["onSelectionChange"], exportAs: ["matOption"] }, { kind: "directive", type: MatTooltip, selector: "[matTooltip]", inputs: ["matTooltipPosition", "matTooltipPositionAtOrigin", "matTooltipDisabled", "matTooltipShowDelay", "matTooltipHideDelay", "matTooltipTouchGestures", "matTooltip", "matTooltipClass"], exportAs: ["matTooltip"] }, { kind: "directive", type: MatHint, selector: "mat-hint", inputs: ["align", "id"] }, { kind: "component", type: MatIcon, selector: "mat-icon", inputs: ["color", "inline", "svgIcon", "fontSet", "fontIcon"], exportAs: ["matIcon"] }, { kind: "directive", type: MatSuffix, selector: "[matSuffix], [matIconSuffix], [matTextSuffix]", inputs: ["matTextSuffix"] }, { kind: "component", type: MatProgressBar, selector: "mat-progress-bar", inputs: ["color", "value", "bufferValue", "mode"], outputs: ["animationEnd"], exportAs: ["matProgressBar"] }, { kind: "pipe", type: AsyncPipe, name: "async" }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: LookupWorkOrderComponent, decorators: [{
            type: Component,
            args: [{ selector: 'sii-lookup-work-order', providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(() => LookupWorkOrderComponent),
                            multi: true,
                        },
                        { provide: NG_VALIDATORS, useExisting: LookupWorkOrderComponent, multi: true },
                    ], standalone: true, imports: [
                        MatFormField,
                        NgClass,
                        MatLabel,
                        MatInput,
                        MatAutocompleteTrigger,
                        FormsModule,
                        ReactiveFormsModule,
                        MatAutocomplete,
                        MatOptgroup,
                        MatOption,
                        MatTooltip,
                        MatHint,
                        MatIcon,
                        MatSuffix,
                        MatProgressBar,
                        AsyncPipe,
                    ], template: "<div class=\"lio-mff-container lio-io-cont\" >\r\n  <mat-form-field [appearance]=\"appearance\"  [ngClass]=\"{'lio_fc_invalid': !utils.internalOrderValid}\" >\r\n\r\n    @if(!!label){\r\n      <mat-label>{{label}}</mat-label>\r\n    }\r\n    @else if (!hideIO && !hideCdc) {\r\n        <mat-label i18n=\"@@lookIOCdc_internalorder_cdc\" >Work Order / CDC</mat-label>\r\n      }\r\n    @else if (hideIO) {\r\n        <mat-label i18n=\"@@lookIOCdc_cdc\" >CDC</mat-label>\r\n      }\r\n    @else if (hideCdc) {\r\n        <mat-label i18n=\"@@lookIOCdc_internalorder\" >Work Order</mat-label>\r\n      }\r\n    \r\n\r\n    <input matInput [required]=\"required\"\r\n      aria-label=\"Internal order / cdc\"\r\n      [matAutocomplete]=\"lookupInternalOrderAutocompleteRef\"\r\n      [formControl]=\"lookupInternalOrderComponentCtrl\"  >\r\n      <mat-autocomplete #lookupInternalOrderAutocompleteRef=\"matAutocomplete\"  [displayWith]=\"displayFn\"  class=\"lioAutoComplete\" (optionSelected)=\"onSelectionChanged($event)\">\r\n\r\n        @if (!hideIO) {\r\n          <mat-optgroup label=\"Work Orders\" i18n-label=\"@@lookIOCdc_internalorders\">\r\n            @for (intOrd of internalOrderRestObs | async; track intOrd) {\r\n              <mat-option [value]=\"intOrd\" style=\"border-bottom: 1px solid lightgray;\"\r\n                [matTooltip]=\"intOrd.itemId +' | ' +intOrd.itemDescription\" matTooltipShowDelay=1000>\r\n                <div class=\"lioAutocompleteItems\">\r\n                  <span class=\"lioAutocompleteItemsId\">{{intOrd.itemId}}</span>\r\n                  <span class=\"lioAutocompleteItemsDescr\">{{intOrd.itemDescription}}</span>\r\n                </div>\r\n              </mat-option>\r\n            }\r\n          </mat-optgroup>\r\n        }\r\n\r\n        @if (!hideCdc) {\r\n          <mat-optgroup label=\"CDC\" i18n-label=\"@@lookIOCdc_cdc\">\r\n            @for (intOrd of cdcRestObs | async; track intOrd) {\r\n              <mat-option [value]=\"intOrd\" style=\"border-bottom: 1px solid lightgray;\"\r\n                [matTooltip]=\"intOrd.itemId +' | ' +intOrd.itemDescription\" matTooltipShowDelay=1000>\r\n                <div class=\"lioAutocompleteItems\">\r\n                  <span class=\"lioAutocompleteItemsId\">{{intOrd.itemId}}</span>\r\n                  <span class=\"lioAutocompleteItemsDescr\">{{intOrd.itemDescription}}</span>\r\n                </div>\r\n              </mat-option>\r\n            }\r\n          </mat-optgroup>\r\n        }\r\n      </mat-autocomplete>\r\n\r\n      @if (selectedItem!=undefined) {\r\n        <mat-hint class=\"lioHint\"  [matTooltip]=\"selectedItem.commessaDescrizione\" >{{selectedItem.commessaDescrizione}}</mat-hint>\r\n      }\r\n      <mat-icon [style.visibility]=\"!(disabled!==false) ? 'initial' : 'hidden'\" style=\"cursor: pointer;\" matSuffix (click)=\"searchPopup();$event.stopPropagation();\">search</mat-icon>\r\n    </mat-form-field>\r\n    @if (utils.ioLoadingInProgress || utils.cdcLoadingInProgress) {\r\n      <mat-progress-bar class=\"lioProgressBar\" mode=\"query\"></mat-progress-bar>\r\n    }\r\n  </div>\r\n\r\n\r\n\r\n\r\n  @if(!hideSS){\r\n  <div class=\"lio-mff-container\">\r\n    <mat-form-field [appearance]=\"appearance\"    [ngClass]=\"{'lio_fc_invalid': !utils.subSystemValid}\" >\r\n      <mat-label i18n=\"@@lookIOCdc_subsystem\" >Sub System</mat-label>\r\n      <input matInput [required]=\"required\"\r\n        aria-label=\"Sub System\"\r\n        [matAutocomplete]=\"lookupSubSystemAutocompleteRef\"\r\n        [formControl]=\"lookupSubSystemComponentCtrl\"  >\r\n\r\n        <mat-autocomplete #lookupSubSystemAutocompleteRef=\"matAutocomplete\"    class=\"lioAutoComplete\" [displayWith]=\"displayComSSFn\" (optionSelected)=\"onComSSSelectionChanged($event)\">\r\n          @for (comss of subSystemDataObs | async; track comss) {\r\n            <mat-option [value]=\"comss\"\r\n              [matTooltip]=\"comss.comSS +' | ' +comss.comSSDescription\" matTooltipShowDelay=1000>\r\n              <div class=\"lioAutocompleteItems\">\r\n                <span class=\"lioAutocompleteItemsId\">{{comss.comSS}}</span>\r\n                <span class=\"lioAutocompleteItemsDescr\">{{comss.comSSDescription}}</span>\r\n              </div>\r\n            </mat-option>\r\n          }\r\n        </mat-autocomplete>\r\n        @if (selectedItem!=undefined) {\r\n          <mat-hint class=\"lioHint\"  [matTooltip]=\"selectedItem.comSSDescrizione\" >{{selectedItem.comSSDescrizione}}</mat-hint>\r\n        }\r\n      </mat-form-field>\r\n      @if (utils.subsystemLoadingInProgress) {\r\n        <mat-progress-bar class=\"lioProgressBar\" mode=\"query\"></mat-progress-bar>\r\n      }\r\n    </div>\r\n  }", styles: [":host{display:flex;flex-wrap:wrap}.lioHint{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.lio-io-cont{margin-right:10px}.lioAutocompleteItems{display:flex;flex-direction:column}.lioAutocompleteItems .lioAutocompleteItemsId{line-height:20px}.lioAutocompleteItems .lioAutocompleteItemsDescr{line-height:12px;font-size:10px;max-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}::ng-deep .lioAutoComplete .mat-mdc-option{padding:0 5px!important;border-bottom:1px solid lightgray}::ng-deep .lioAutoComplete .mat-mdc-optgroup-label{background-color:#d3d3d3;text-align:center;font-weight:700;color:#000}.lio_fc_invalid.ng-touched::ng-deep .mdc-notched-outline>*{border-color:red!important}.lio_fc_invalid.ng-touched::ng-deep mat-label{color:red!important}.lio_fc_invalid.ng-touched::ng-deep .mdc-line-ripple:before,.lio_fc_invalid.ng-touched::ng-deep .mdc-line-ripple:after{border-bottom-color:red!important}.lio-mff-container{position:relative;flex:1}.lio-mff-container>mat-form-field{width:100%}.lioProgressBar{height:2px;position:absolute;bottom:16px}\n"] }]
        }], ctorParameters: () => [{ type: i1.HttpClient }, { type: i2.MatDialog }, { type: i3.SiiToolkitService }], propDecorators: { label: [{
                type: Input
            }], hideCdc: [{
                type: Input
            }], hideIO: [{
                type: Input
            }], hideSS: [{
                type: Input
            }], appearance: [{
                type: Input
            }], codSociety: [{
                type: Input
            }], required: [{
                type: Input
            }], disabled: [{
                type: Input
            }], customIORestFunct: [{
                type: Input
            }], customCDCRestFunct: [{
                type: Input
            }], customPageableIORestFunct: [{
                type: Input
            }], customPageableCDCRestFunct: [{
                type: Input
            }], refresh: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9va3VwLXdvcmstb3JkZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvc2lpLXRvb2xraXQvc3JjL2xpYi9jb21wb25lbnRzL2RzaWktY29tcG9uZW50cy9sb29rdXAtd29yay1vcmRlci9sb29rdXAtd29yay1vcmRlci5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9zaWktdG9vbGtpdC9zcmMvbGliL2NvbXBvbmVudHMvZHNpaS1jb21wb25lbnRzL2xvb2t1cC13b3JrLW9yZGVyL2xvb2t1cC13b3JrLW9yZGVyLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBRSxTQUFTLEVBQWdCLFVBQVUsRUFBRSxLQUFLLEVBQTRDLE1BQU0sZUFBZSxDQUFDO0FBQ3JILE9BQU8sRUFBeUMsa0JBQWtCLEVBQUUsYUFBYSxFQUFFLGlCQUFpQixFQUFhLFdBQVcsRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFLLE9BQU8sRUFBZ0Msc0JBQXNCLEVBQUUsZUFBZSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFdkgsT0FBTyxFQUFtQixLQUFLLEVBQWMsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ25FLE9BQU8sRUFBRSxZQUFZLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzVHLE9BQU8sRUFBRSw4QkFBOEIsRUFBRSxNQUFNLDBFQUEwRSxDQUFDO0FBUzFILE9BQU8sRUFBMEIsWUFBWSxFQUFFLFFBQVEsRUFBRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDbEgsT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLGdDQUFnQyxDQUFDO0FBQ2hFLE9BQU8s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LEtBQUs7Z0JBQ0csUUFBUTtzQkFBaEIsS0FBSztnQkFDRyxRQUFRO3NCQUFoQixLQUFLO2dCQUNHLGlCQUFpQjtzQkFBekIsS0FBSztnQkFDRyxrQkFBa0I7c0JBQTFCLEtBQUs7Z0JBRUcseUJBQXlCO3NCQUFqQyxLQUFLO2dCQUVHLDBCQUEwQjtzQkFBbEMsS0FBSztnQkFFRyxPQUFPO3NCQUFmLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50IH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgZm9yd2FyZFJlZiwgSW5wdXQsIE9uQ2hhbmdlcywgT25Jbml0LCBPdXRwdXQsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQWJzdHJhY3RDb250cm9sLCBDb250cm9sVmFsdWVBY2Nlc3NvciwgVW50eXBlZEZvcm1Db250cm9sLCBOR19WQUxJREFUT1JTLCBOR19WQUxVRV9BQ0NFU1NPUiwgVmFsaWRhdG9yLCBGb3Jtc01vZHVsZSwgUmVhY3RpdmVGb3Jtc01vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcclxuaW1wb3J0IHsgTWF0QXV0b2NvbXBsZXRlU2VsZWN0ZWRFdmVudCwgTWF0QXV0b2NvbXBsZXRlVHJpZ2dlciwgTWF0QXV0b2NvbXBsZXRlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvYXV0b2NvbXBsZXRlJztcclxuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZGlhbG9nJztcclxuaW1wb3J0IHsgQmVoYXZpb3JTdWJqZWN0LCBtZXJnZSwgT2JzZXJ2YWJsZSwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xyXG5pbXBvcnQgeyBkZWJvdW5jZVRpbWUsIGRpc3RpbmN0VW50aWxDaGFuZ2VkLCBmaWx0ZXIsIG1hcCwgc3RhcnRXaXRoLCBzd2l0Y2hNYXAsIHRhcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgU2VhcmNoV29ya09yZGVyRGlhbG9nQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnRzL3NlYXJjaC13b3JrLW9yZGVyLWRpYWxvZy9zZWFyY2gtd29yay1vcmRlci1kaWFsb2cuY29tcG9uZW50JztcclxuaW1wb3J0IHsgSUxvb2t1cENkY0RhdGFEVE8gfSBmcm9tICcuL2RvbWFpbi9sb29rdXAtY2RjLWRhdGEuZHRvJztcclxuaW1wb3J0IHsgSUxvb2t1cFdvcmtPcmRlckRhdGFEVE8gfSBmcm9tICcuL2RvbWFpbi9sb29rdXAtd29yay1vcmRlci1kYXRhLmR0byc7XHJcbmltcG9ydCB7IElMb29rdXBXb3JrT3JkZXJEVE8gfSBmcm9tICcuL2RvbWFpbi9sb29rdXAtd29yay1vcmRlci5kdG8nO1xyXG5pbXBvcnQgeyBJTG9va3VwSU9DZGNEYXRhQmFzZURUTyB9IGZyb20gJy4vZG9tYWluL2xvb2t1cC1pby1jZGMtZGF0YS5kdG8nO1xyXG5pbXBvcnQgeyBJTG9va3VwU3ViU3lzdGVtRGF0YURUTyB9IGZyb20gJy4vZG9tYWluL2xvb2t1cC1zdWItc3lzdGVtLWRhdGEuZHRvJztcclxuaW1wb3J0IHsgSVBhZ2VhYmxlTG9va3VwQ2RjRGF0YURUTyB9IGZyb20gJy4vZG9tYWluL3BhZ2VhYmxlLWxvb2t1cC1jZGMtZGF0YS5kdG8uJztcclxuaW1wb3J0IHsgSVBhZ2VhYmxlTG9va3VwV29ya09yZGVyRGF0YURUTyB9IGZyb20gJy4vZG9tYWluL3BhZ2VhYmxlLWxvb2t1cC13b3JrLW9yZGVyLWRhdGEuZHRvJztcclxuaW1wb3J0IHsgU2lpVG9vbGtpdFNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi9zaWktdG9vbGtpdC5zZXJ2aWNlJztcclxuaW1wb3J0IHsgTWF0Rm9ybUZpZWxkQXBwZWFyYW5jZSwgTWF0Rm9ybUZpZWxkLCBNYXRMYWJlbCwgTWF0SGludCwgTWF0U3VmZml4IH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZm9ybS1maWVsZCc7XHJcbmltcG9ydCB7IE1hdFByb2dyZXNzQmFyIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvcHJvZ3Jlc3MtYmFyJztcclxuaW1wb3J0IHsgTWF0SWNvbiB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2ljb24nO1xyXG5pbXBvcnQgeyBNYXRUb29sdGlwIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvdG9vbHRpcCc7XHJcbmltcG9ydCB7IE1hdE9wdGdyb3VwLCBNYXRPcHRpb24gfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9jb3JlJztcclxuaW1wb3J0IHsgTWF0SW5wdXQgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9pbnB1dCc7XHJcbmltcG9ydCB7IE5nQ2xhc3MsIEFzeW5jUGlwZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XHJcblxyXG5pbnRlcmZhY2UgSXJlc3BvbnNlRXJyb3Ige1xyXG4gIGludGVybmFsT3JkZXJJbnZhbGlkOiBib29sZWFuO1xyXG4gIHJlcXVpcmVkOiBib29sZWFuO1xyXG4gIHN1YlN5c3RlbUludmFsaWQ6IGJvb2xlYW47XHJcbiAgc3ViU3lzdGVtUmVxdWlyZWQ6IGJvb2xlYW47XHJcbn1cclxuXHJcbkBDb21wb25lbnQoe1xyXG4gICAgc2VsZWN0b3I6ICdzaWktbG9va3VwLXdvcmstb3JkZXInLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL2xvb2t1cC13b3JrLW9yZGVyLmNvbXBvbmVudC5odG1sJyxcclxuICAgIHN0eWxlVXJsczogWycuL2xvb2t1cC13b3JrLW9yZGVyLmNvbXBvbmVudC5zY3NzJ10sXHJcbiAgICBwcm92aWRlcnM6IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxyXG4gICAgICAgICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBMb29rdXBXb3JrT3JkZXJDb21wb25lbnQpLFxyXG4gICAgICAgICAgICBtdWx0aTogdHJ1ZSxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHsgcHJvdmlkZTogTkdfVkFMSURBVE9SUywgdXNlRXhpc3Rpbmc6IExvb2t1cFdvcmtPcmRlckNvbXBvbmVudCwgbXVsdGk6IHRydWUgfSxcclxuICAgIF0sXHJcbiAgICBzdGFuZGFsb25lOiB0cnVlLFxyXG4gICAgaW1wb3J0czogW1xyXG4gICAgICAgIE1hdEZvcm1GaWVsZCxcclxuICAgICAgICBOZ0NsYXNzLFxyXG4gICAgICAgIE1hdExhYmVsLFxyXG4gICAgICAgIE1hdElucHV0LFxyXG4gICAgICAgIE1hdEF1dG9jb21wbGV0ZVRyaWdnZXIsXHJcbiAgICAgICAgRm9ybXNNb2R1bGUsXHJcbiAgICAgICAgUmVhY3RpdmVGb3Jtc01vZHVsZSxcclxuICAgICAgICBNYXRBdXRvY29tcGxldGUsXHJcbiAgICAgICAgTWF0T3B0Z3JvdXAsXHJcbiAgICAgICAgTWF0T3B0aW9uLFxyXG4gICAgICAgIE1hdFRvb2x0aXAsXHJcbiAgICAgICAgTWF0SGludCxcclxuICAgICAgICBNYXRJY29uLFxyXG4gICAgICAgIE1hdFN1ZmZpeCxcclxuICAgICAgICBNYXRQcm9ncmVzc0JhcixcclxuICAgICAgICBBc3luY1BpcGUsXHJcbiAgICBdLFxyXG59KVxyXG5cclxuZXhwb3J0IGNsYXNzIExvb2t1cFdvcmtPcmRlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQ29udHJvbFZhbHVlQWNjZXNzb3IsIFZhbGlkYXRvciwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKSBsYWJlbDogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIGhpZGVDZGMgPSBmYWxzZTtcclxuICBASW5wdXQoKSBoaWRlSU8gPSBmYWxzZTtcclxuICBASW5wdXQoKSBoaWRlU1MgPSBmYWxzZTtcclxuICBASW5wdXQoKSBhcHBlYXJhbmNlID0gJ291dGxpbmUnIGFzIE1hdEZvcm1GaWVsZEFwcGVhcmFuY2U7XHJcbiAgQElucHV0KCkgY29kU29jaWV0eTogc3RyaW5nO1xyXG4gIEBJbnB1dCgpIHJlcXVpcmVkID0gZmFsc2U7XHJcbiAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcclxuICBASW5wdXQoKSBjdXN0b21JT1Jlc3RGdW5jdDogKHR4dDogc3RyaW5nKSA9PiBPYnNlcnZhYmxlPElMb29rdXBJT0NkY0RhdGFCYXNlRFRPW10+O1xyXG4gIEBJbnB1dCgpIGN1c3RvbUNEQ1Jlc3RGdW5jdDogKHR4dDogc3RyaW5nKSA9PiBPYnNlcnZhYmxlPElMb29rdXBJT0NkY0RhdGFCYXNlRFRPW10+O1xyXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuICBASW5wdXQoKSBjdXN0b21QYWdlYWJsZUlPUmVzdEZ1bmN0OiAodHh0OiBzdHJpbmcsIHBhZ2U6IG51bWJlciwgc2l6ZTogbnVtYmVyLCBzb3J0RmllbGQ6IHN0cmluZywgc29ydERpcmVjdGlvbjogc3RyaW5nKSA9PiBPYnNlcnZhYmxlPElQYWdlYWJsZUxvb2t1cFdvcmtPcmRlckRhdGFEVE8+O1xyXG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcclxuICBASW5wdXQoKSBjdXN0b21QYWdlYWJsZUNEQ1Jlc3RGdW5jdDogKHR4dDogc3RyaW5nLCBwYWdlOiBudW1iZXIsIHNpemU6IG51bWJlciwgc29ydEZpZWxkOiBzdHJpbmcsIHNvcnREaXJlY3Rpb246IHN0cmluZykgPT4gT2JzZXJ2YWJsZTxJUGFnZWFibGVMb29rdXBDZGNEYXRhRFRPPjtcclxuXHJcbiAgQElucHV0KCkgcmVmcmVzaDpTdWJqZWN0PHN0cmluZz47XHJcblxyXG4gIGRlZmF1bHRDb21TUyA9IHsgY29tU1M6ICdBQTAxJywgY29tU1NEZXNjcmlwdGlvbjogJ0FBMDEnIH07XHJcblxyXG4gIGxvb2t1cEludGVybmFsT3JkZXJDb21wb25lbnRDdHJsID0gbmV3IFVudHlwZWRGb3JtQ29udHJvbCgpO1xyXG4gIGxvb2t1cFN1YlN5c3RlbUNvbXBvbmVudEN0cmwgPSBuZXcgVW50eXBlZEZvcm1Db250cm9sKCk7XHJcblxyXG4gIGludGVybmFsT3JkZXJSZXN0T2JzOiBPYnNlcnZhYmxlPElMb29rdXBJT0NkY0RhdGFCYXNlRFRPW10+OyAvLyBsaXN0YSBkaSByaXN1bHRhdGkgY29tbWVzc2FcclxuICBjZGNSZXN0T2JzOiBPYnNlcnZhYmxlPElMb29rdXBJT0NkY0RhdGFCYXNlRFRPW10+OyAvLyBsaXN0YSBkaSByaXN1bHRhdGkgY2RjXHJcblxyXG4gIHN1YlN5c3RlbURhdGFPYnM6IE9ic2VydmFibGU8SUxvb2t1cFN1YlN5c3RlbURhdGFEVE9bXT47XHJcbiAgc3ViU3lzdGVtRGF0YTogSUxvb2t1cFN1YlN5c3RlbURhdGFEVE9bXSA9IFtdO1xyXG4gIHN1YmplY3RTdWJTeXN0ZW1EYXRhQ2hhbmdlID0gbmV3IFN1YmplY3Q8c3RyaW5nIHwgdm9pZD4oKTtcclxuICBzdWJqZWN0T25DaGFuZ2UgPSBuZXcgU3ViamVjdDxzdHJpbmcgfCB2b2lkPigpO1xyXG5cclxuICBzZWxlY3RlZEl0ZW06IElMb29rdXBXb3JrT3JkZXJEVE8gPSB7fSBhcyBJTG9va3VwV29ya09yZGVyRFRPO1xyXG5cclxuICB1dGlscyA9IHtcclxuICAgIHN1YnN5c3RlbUxvYWRpbmdJblByb2dyZXNzOiBmYWxzZSxcclxuICAgIGlvTG9hZGluZ0luUHJvZ3Jlc3M6IGZhbHNlLFxyXG4gICAgY2RjTG9hZGluZ0luUHJvZ3Jlc3M6IGZhbHNlLFxyXG4gICAgaW50ZXJuYWxPcmRlclZhbGlkOiB0cnVlLFxyXG4gICAgc3ViU3lzdGVtVmFsaWQ6IHRydWUsXHJcbiAgICBmb3JjZVNlYXJjaDogMCxcclxuICB9O1xyXG5cclxuICBwcm9wYWdhdGVDaGFuZ2U6IGFueSA9ICgpID0+IHsgfTtcclxuICBvblRvdWNoZWRDYWxsYmFjazogYW55ID0gKCkgPT4geyB9O1xyXG4gIHZhbGlkYXRvckNhbGxiYWNrOiBhbnkgPSAoKSA9PiB7IH07XHJcblxyXG4gIG5nT25Jbml0KCkge1xyXG4gICAgLy8gdGhpcy5jaGVja1N1YlN5c3RlbVZhbHVlKCk7XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgaHR0cDogSHR0cENsaWVudCwgcHVibGljIGRpYWxvZzogTWF0RGlhbG9nLCBwdWJsaWMgc2lpVG9vbGtpdFNlcnZpY2U6IFNpaVRvb2xraXRTZXJ2aWNlKSB7XHJcblxyXG4gICAgLy8gcmljZXJjbyBsZSBjb21tZXNzYSBpbiBiYXNlIGFsIHZhbG9yZSBpbnNlcml0byBuZWwgY2FtcG8gZGkgaW5wdXRcclxuICAgIHRoaXMuaW50ZXJuYWxPcmRlclJlc3RPYnMgPSB0aGlzLmdldGNvbW1DZGNJbnB1dFZhbHVlQ2hhbmdlT2JzZXJ2ZXIoKVxyXG4gICAgICAucGlwZShcclxuICAgICAgICB0YXAoKHJlcykgPT4gdGhpcy51dGlscy5pb0xvYWRpbmdJblByb2dyZXNzID0gdHJ1ZSksXHJcbiAgICAgICAgLy8gc3dpdGNoTWFwKCh2YWwpID0+IHRoaXMuZ2V0SU9EYXRhRnJvbVNlcnZlcih2YWwpKSxcclxuICAgICAgICBzd2l0Y2hNYXAoKHZhbCkgPT4gdGhpcy5nZXRJT0RhdGFGcm9tU2VydmVyKHZhbCkpLFxyXG4gICAgICAgIHRhcCgocmVzKSA9PiB0aGlzLnV0aWxzLmlvTG9hZGluZ0luUHJvZ3Jlc3MgPSBmYWxzZSksXHJcbiAgICAgICk7XHJcblxyXG4gICAgLy8gcmljZXJjbyBpIGNkYyBpbiBiYXNlIGFsIHZhbG9yZSBpbnNlcml0byBuZWwgY2FtcG8gZGkgaW5wdXRcclxuICAgIHRoaXMuY2RjUmVzdE9icyA9IHRoaXMuZ2V0Y29tbUNkY0lucHV0VmFsdWVDaGFuZ2VPYnNlcnZlcigpXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIHRhcCgocmVzKSA9PiB0aGlzLnV0aWxzLmNkY0xvYWRpbmdJblByb2dyZXNzID0gdHJ1ZSksXHJcbiAgICAgICAgc3dpdGNoTWFwKCh2YWwpID0+IHRoaXMuZ2V0Q0RDRGF0YUZyb21TZXJ2ZXIodmFsKSksXHJcbiAgICAgICAgdGFwKChyZXMpID0+IHRoaXMudXRpbHMuY2RjTG9hZGluZ0luUHJvZ3Jlc3MgPSBmYWxzZSksXHJcbiAgICAgICk7XHJcblxyXG4gICAgLy8gcmljZXJjbyBpIHNvdHRvc2lzdGVtaSBpbiBiYXNlIGFsIHZhbG9yZSBpbnNlcml0byBuZWwgY2FtcG8gZGkgaW5wdXQgbyBhbCBjYW1iaWFtZW50byBkaSBjb21tZXNzYS9jZGNcclxuICAgIHRoaXMuc3ViU3lzdGVtRGF0YU9icyA9IG1lcmdlKHRoaXMubG9va3VwU3ViU3lzdGVtQ29tcG9uZW50Q3RybC52YWx1ZUNoYW5nZXMsIHRoaXMuc3ViamVjdFN1YlN5c3RlbURhdGFDaGFuZ2UpXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIHN0YXJ0V2l0aChudWxsKSxcclxuICAgICAgICB0YXAoKHRleHQpID0+IHsgaWYgKHR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJykgeyB0aGlzLmNvbVNTQ2hhbmdlKHsgY29tU1M6IHRleHQsIGNvbVNTRGVzY3JpcHRpb246IHRleHQgfSwgZmFsc2UpOyB9IH0pLFxyXG4gICAgICAgIGZpbHRlcigodGV4dCkgPT4gdGV4dCA9PSBudWxsIHx8IHR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJyksXHJcbiAgICAgICAgbWFwKCh0eHQpID0+IHtcclxuICAgICAgICAgIHJldHVybiB0eHQgPyB0aGlzLl9maWx0ZXJTdWJTeXN0ZW0odHh0IGFzIHN0cmluZykgOiB0aGlzLnN1YlN5c3RlbURhdGEuc2xpY2UoKTtcclxuICAgICAgICB9KSxcclxuICAgICAgKTtcclxuXHJcbiAgICB0aGlzLnN1YmplY3RPbkNoYW5nZS5waXBlKGRlYm91bmNlVGltZSg1MDApKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5vbkNoYW5nZSgpKTtcclxuXHJcbiAgfVxyXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcclxuICAgIGlmKGNoYW5nZXMucmVmcmVzaCAmJiB0aGlzLnJlZnJlc2ghPW51bGwpe1xyXG4gICAgICB0aGlzLnJlZnJlc2guc3Vic2NyaWJlKChpb0NkY1RleHQ6c3RyaW5nKT0+e1xyXG4gICAgICAgIHRoaXMudXRpbHMuZm9yY2VTZWFyY2ggPSAyO1xyXG4gICAgICAgIHRoaXMubG9va3VwSW50ZXJuYWxPcmRlckNvbXBvbmVudEN0cmwuc2V0VmFsdWUoaW9DZGNUZXh0KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRjb21tQ2RjSW5wdXRWYWx1ZUNoYW5nZU9ic2VydmVyKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubG9va3VwSW50ZXJuYWxPcmRlckNvbXBvbmVudEN0cmwudmFsdWVDaGFuZ2VzXHJcbiAgICAgIC5waXBlKFxyXG4gICAgICAgIHRhcCgodGV4dCkgPT4geyBpZiAodHlwZW9mIHRleHQgPT09ICdzdHJpbmcnKSB7IHRoaXMuaW9DZGNDaGFuZ2UobnVsbCk7IHRoaXMuY29tU1NDaGFuZ2UobnVsbCk7IH0gfSksXHJcbiAgICAgICAgZmlsdGVyKCh0ZXh0KSA9PnR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJyAmJiAoICEhdGhpcy51dGlscy5mb3JjZVNlYXJjaCB8fCB0ZXh0Lmxlbmd0aCA+IDIpKSxcclxuICAgICAgICBkZWJvdW5jZVRpbWUoNTAwKSxcclxuICAgICAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgoYSxiKT0+e3JldHVybiBhPT09YiAmJiAhdGhpcy51dGlscy5mb3JjZVNlYXJjaDt9ICksXHJcbiAgICAgICAgdGFwKCgpPT50aGlzLnV0aWxzLmZvcmNlU2VhcmNoLS0pLFxyXG4gICAgICApO1xyXG4gIH1cclxuXHJcbiAgZGlzcGxheUZuKGludE9yZD86IElMb29rdXBXb3JrT3JkZXJEYXRhRFRPIHwgSUxvb2t1cENkY0RhdGFEVE8pOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgcmV0dXJuIGludE9yZCA/IGludE9yZC5pdGVtSWQgOiB1bmRlZmluZWQ7XHJcbiAgfVxyXG5cclxuICBkaXNwbGF5Q29tU1NGbihpbnRPcmQ/OiBJTG9va3VwU3ViU3lzdGVtRGF0YURUTyk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XHJcbiAgICByZXR1cm4gaW50T3JkID8gaW50T3JkLmNvbVNTIDogdW5kZWZpbmVkO1xyXG4gIH1cclxuXHJcbiAgLy8gc2VsZXppb25lIGRpIGNvbVNTIGRhbGwnYXV0b2NvbXBsZXRlXHJcbiAgb25Db21TU1NlbGVjdGlvbkNoYW5nZWQoZXZlbnQ6IE1hdEF1dG9jb21wbGV0ZVNlbGVjdGVkRXZlbnQpIHtcclxuICAgIHRoaXMuY29tU1NDaGFuZ2UoZXZlbnQub3B0aW9uLnZhbHVlLCBmYWxzZSk7XHJcbiAgfVxyXG5cclxuICBjb21TU0NoYW5nZShjb21TUzogSUxvb2t1cFN1YlN5c3RlbURhdGFEVE8sIHVwZGF0ZUlucHV0VmFsdWUgPSB0cnVlKSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbS5jb21TUyA9IGNvbVNTICE9IG51bGwgPyBjb21TUy5jb21TUyA6IG51bGw7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbS5jb21TU0Rlc2NyaXppb25lID0gY29tU1MgIT0gbnVsbCA/IGNvbVNTLmNvbVNTRGVzY3JpcHRpb24gOiBudWxsO1xyXG4gICAgdGhpcy5zZWxlY3RlZEl0ZW0uY29tU1NEZXNjcml6aW9uZSA9IGNvbVNTICE9IG51bGwgPyBjb21TUy5jb21TU0Rlc2NyaXB0aW9uIDogbnVsbDtcclxuICAgIGlmICh1cGRhdGVJbnB1dFZhbHVlKSB7XHJcbiAgICAgIHRoaXMudXBkYXRlU3ViU3lzdGVtQ29tcG9uZW50VmFsdWUoKTtcclxuICAgIH1cclxuICAgIHRoaXMuc3ViamVjdE9uQ2hhbmdlLm5leHQoKTtcclxuICB9XHJcblxyXG4gIGlvQ2RjQ2hhbmdlKGl0ZW06IElMb29rdXBJT0NkY0RhdGFCYXNlRFRPKSB7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbS5jb21tZXNzYSA9IGl0ZW0gIT0gbnVsbCA/IGl0ZW0uaXRlbUlkIDogbnVsbDtcclxuICAgIHRoaXMuc2VsZWN0ZWRJdGVtLmNvbW1lc3NhRGVzY3JpemlvbmUgPSBpdGVtICE9IG51bGwgPyBpdGVtLml0ZW1EZXNjcmlwdGlvbiA6IG51bGw7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbS50eXBlID0gaXRlbSAhPSBudWxsID8gaXRlbS50eXBlIDogbnVsbDtcclxuICAgIHRoaXMuc2VsZWN0ZWRJdGVtLl9kYkRhdGE9aXRlbSBhcyBhbnk7XHJcbiAgICB0aGlzLnN1YmplY3RPbkNoYW5nZS5uZXh0KCk7XHJcbiAgICBpZighdGhpcy5oaWRlU1Mpe1xyXG4gICAgICAgIHRoaXMubG9hZFN1YlN5c3RlbSgpO1xyXG4gICAgICB9XHJcbiAgfVxyXG5cclxuICBvblNlbGVjdGlvbkNoYW5nZWQoZXZlbnQ6IE1hdEF1dG9jb21wbGV0ZVNlbGVjdGVkRXZlbnQpIHtcclxuICAgIHRoaXMuaW9DZGNDaGFuZ2UoZXZlbnQub3B0aW9uLnZhbHVlKTtcclxuICB9XHJcblxyXG4gIGxvYWRTdWJTeXN0ZW0oKSB7XHJcbiAgICB0aGlzLnN1YlN5c3RlbURhdGEgPSBbXTtcclxuICAgIHRoaXMuc3ViamVjdFN1YlN5c3RlbURhdGFDaGFuZ2UubmV4dCgpO1xyXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWRJdGVtICE9IG51bGwgJiYgdGhpcy5zZWxlY3RlZEl0ZW0uY29tbWVzc2EgIT0gbnVsbCkge1xyXG4gICAgICB0aGlzLnV0aWxzLnN1YnN5c3RlbUxvYWRpbmdJblByb2dyZXNzID0gdHJ1ZTtcclxuICAgICAgdGhpcy5odHRwLmdldDxJTG9va3VwU3ViU3lzdGVtRGF0YURUT1tdPihcclxuICAgICAgICBgJHt0aGlzLnNpaVRvb2xraXRTZXJ2aWNlLmVudmlyb25tZW50LmRvbWFpbn0vbG9va3VwL2NvbVNTP2ludGVybmFsT3JkZXI9JHtlbmNvZGVVUklDb21wb25lbnQodGhpcy5zZWxlY3RlZEl0ZW0uY29tbWVzc2EpfWApXHJcbiAgICAgICAgLnN1YnNjcmliZSgocmVzKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnN1YlN5c3RlbURhdGEgPSByZXM7XHJcbiAgICAgICAgICB0aGlzLmNvbVNTQ2hhbmdlKHJlcy5sZW5ndGggPiAwID8gcmVzWzBdIDogdGhpcy5kZWZhdWx0Q29tU1MpO1xyXG4gICAgICAgICAgdGhpcy5zdWJqZWN0U3ViU3lzdGVtRGF0YUNoYW5nZS5uZXh0KCk7XHJcbiAgICAgICAgICB0aGlzLnV0aWxzLnN1YnN5c3RlbUxvYWRpbmdJblByb2dyZXNzID0gZmFsc2U7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNoZWNrRW5hYmxlQ29tU1MoKSB7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXHJcbiAgICBjb25zdCBpdGVtVmFsdWVWYWxpZEFuZEVuYWJsZWQgPSB0aGlzLnNlbGVjdGVkSXRlbSAhPSBudWxsICYmIHRoaXMuc2VsZWN0ZWRJdGVtLmNvbW1lc3NhICE9IG51bGwgJiYgdGhpcy5sb29rdXBJbnRlcm5hbE9yZGVyQ29tcG9uZW50Q3RybC5lbmFibGVkO1xyXG5cclxuICAgIGlmIChpdGVtVmFsdWVWYWxpZEFuZEVuYWJsZWQgJiYgdGhpcy5sb29rdXBTdWJTeXN0ZW1Db21wb25lbnRDdHJsLmRpc2FibGVkKSB7XHJcbiAgICAgIHRoaXMubG9va3VwU3ViU3lzdGVtQ29tcG9uZW50Q3RybC5lbmFibGUoKTtcclxuICAgIH0gZWxzZSBpZiAoIWl0ZW1WYWx1ZVZhbGlkQW5kRW5hYmxlZCAmJiB0aGlzLmxvb2t1cFN1YlN5c3RlbUNvbXBvbmVudEN0cmwuZW5hYmxlZCkge1xyXG4gICAgICB0aGlzLmxvb2t1cFN1YlN5c3RlbUNvbXBvbmVudEN0cmwuZGlzYWJsZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfZmlsdGVyU3ViU3lzdGVtKHZhbHVlOiBzdHJpbmcpOiBJTG9va3VwU3ViU3lzdGVtRGF0YURUT1tdIHtcclxuICAgIGNvbnN0IGZpbHRlclZhbHVlID0gdmFsdWUudG9Mb3dlckNhc2UoKTtcclxuICAgIHJldHVybiB0aGlzLnN1YlN5c3RlbURhdGEuZmlsdGVyKCh2YWwpID0+IHZhbC5jb21TUy50b0xvd2VyQ2FzZSgpLmluZGV4T2YoZmlsdGVyVmFsdWUpID09PSAwKTtcclxuICB9XHJcblxyXG4gIGdldElPRGF0YUZyb21TZXJ2ZXIodHh0OiBzdHJpbmcpIHtcclxuICAgIHJldHVybiAodGhpcy5jdXN0b21JT1Jlc3RGdW5jdCA9PT0gdW5kZWZpbmVkID8gdGhpcy51c2VJT0RlZmF1bHRSZXN0T2JzKHR4dCkgOiB0aGlzLmN1c3RvbUlPUmVzdEZ1bmN0KHR4dCkpXHJcbiAgICAucGlwZShtYXAoeD0+e3guZm9yRWFjaChpPT5pLnR5cGU9J0lPJyk7IHJldHVybiB4O30pKTtcclxuICB9XHJcblxyXG4gIGdldENEQ0RhdGFGcm9tU2VydmVyKHR4dDogc3RyaW5nKTpPYnNlcnZhYmxlPGFueT4ge1xyXG4gICAgcmV0dXJuICh0aGlzLmN1c3RvbUNEQ1Jlc3RGdW5jdCA9PT0gdW5kZWZpbmVkID8gdGhpcy51c2VDRENEZWZhdWx0UmVzdE9icyh0eHQpIDogdGhpcy5jdXN0b21DRENSZXN0RnVuY3QodHh0KSlcclxuICAgIC5waXBlKG1hcCh4PT57eC5mb3JFYWNoKGk9PmkudHlwZT0nQ0RDJyk7IHJldHVybiB4O30pKTs7XHJcbiAgfVxyXG5cclxuICB1c2VJT0RlZmF1bHRSZXN0T2JzKHR4dDogc3RyaW5nKSB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8SUxvb2t1cElPQ2RjRGF0YUJhc2VEVE9bXT4oYCR7dGhpcy5zaWlUb29sa2l0U2VydmljZS5lbnZpcm9ubWVudC5kb21haW59L2xvb2t1cC9pbnRlcm5hbF9vcmRlci9zaW1wbGVgLFxyXG4gICAgICB7XHJcbiAgICAgICAgdGV4dDogdHh0LFxyXG4gICAgICAgIGNvZFNvY2lldHk6IHRoaXMuY29kU29jaWV0eSxcclxuICAgICAgfSk7XHJcblxyXG4gIH1cclxuICB1c2VDRENEZWZhdWx0UmVzdE9icyh0eHQ6IHN0cmluZykge1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0PElMb29rdXBJT0NkY0RhdGFCYXNlRFRPW10+KGAke3RoaXMuc2lpVG9vbGtpdFNlcnZpY2UuZW52aXJvbm1lbnQuZG9tYWlufS9sb29rdXAvY2RjL3NpbXBsZWAsXHJcbiAgICAgIHtcclxuICAgICAgICB0ZXh0OiB0eHQsXHJcbiAgICAgICAgY29kU29jaWV0eTogdGhpcy5jb2RTb2NpZXR5LFxyXG4gICAgICB9KTtcclxuXHJcbiAgfVxyXG5cclxuICBzZWFyY2hQb3B1cCgpIHtcclxuICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oU2VhcmNoV29ya09yZGVyRGlhbG9nQ29tcG9uZW50LCB7XHJcbiAgICAgIHdpZHRoOiAnMTAwdncnLFxyXG4gICAgICBoZWlnaHQ6ICc5NSUnLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgY29kU29jaWV0eTogdGhpcy5jb2RTb2NpZXR5LFxyXG4gICAgICAgIGN1c3RvbVBhZ2VhYmxlSU9SZXN0RnVuY3Q6IHRoaXMuY3VzdG9tUGFnZWFibGVJT1Jlc3RGdW5jdCxcclxuICAgICAgICBjdXN0b21QYWdlYWJsZUNkY1Jlc3RGdW5jdDogdGhpcy5jdXN0b21QYWdlYWJsZUNEQ1Jlc3RGdW5jdCxcclxuICAgICAgICBoaWRlQ2RjOnRoaXMuaGlkZUNkYyxcclxuICAgICAgICBoaWRlSU86dGhpcy5oaWRlSU9cclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKChyZXN1bHQ6IElMb29rdXBXb3JrT3JkZXJEYXRhRFRPKSA9PiB7XHJcbiAgICAgIGlmIChyZXN1bHQgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHRoaXMuaW9DZGNDaGFuZ2UocmVzdWx0KTtcclxuICAgICAgICB0aGlzLnVwZGF0ZUlPQ29tcG9uZW50VmFsdWUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVJT0NvbXBvbmVudFZhbHVlKCkge1xyXG4gICAgdGhpcy5sb29rdXBJbnRlcm5hbE9yZGVyQ29tcG9uZW50Q3RybC5zZXRWYWx1ZSh7XHJcbiAgICAgIGl0ZW1JZDogdGhpcy5zZWxlY3RlZEl0ZW0gIT0gbnVsbCA/ICh0aGlzLnNlbGVjdGVkSXRlbS5jb21tZXNzYSB8fCAnJykgOiAnJyxcclxuICAgICAgaXRlbURlc2NyaXB0aW9uOiB0aGlzLnNlbGVjdGVkSXRlbSAhPSBudWxsID8gKHRoaXMuc2VsZWN0ZWRJdGVtLmNvbW1lc3NhRGVzY3JpemlvbmUgfHwgJycpIDogJycsXHJcbiAgICB9KTtcclxuICB9XHJcbiAgdXBkYXRlU3ViU3lzdGVtQ29tcG9uZW50VmFsdWUoKSB7XHJcbiAgICB0aGlzLmxvb2t1cFN1YlN5c3RlbUNvbXBvbmVudEN0cmwuc2V0VmFsdWUoe1xyXG4gICAgICBjb21TUzogdGhpcy5zZWxlY3RlZEl0ZW0gIT0gbnVsbCA/ICh0aGlzLnNlbGVjdGVkSXRlbS5jb21TUyB8fCAnJykgOiAnJyxcclxuICAgICAgY29tU1NEZXNjcmlwdGlvbjogdGhpcy5zZWxlY3RlZEl0ZW0gIT0gbnVsbCA/ICh0aGlzLnNlbGVjdGVkSXRlbS5jb21TU0Rlc2NyaXppb25lIHx8ICcnKSA6ICcnLFxyXG4gICAgfSk7XHJcblxyXG4gIH1cclxuXHJcbiAgLy8gbWV0b2RpIHBlciBsYSBnZXN0aW9uZSBkZWxsJ25nTW9kZWxcclxuICB3cml0ZVZhbHVlKHZhbHVlOiBJTG9va3VwV29ya09yZGVyRFRPKTogdm9pZCB7XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IHZhbHVlO1xyXG4gICAgdGhpcy51cGRhdGVJT0NvbXBvbmVudFZhbHVlKCk7XHJcbiAgICB0aGlzLnVwZGF0ZVN1YlN5c3RlbUNvbXBvbmVudFZhbHVlKCk7XHJcbiAgICB0aGlzLmNoZWNrRW5hYmxlQ29tU1MoKTtcclxuICB9XHJcblxyXG4gIG9uQ2hhbmdlKCkge1xyXG4gICAgLy8gdGhpcy5vblRvdWNoZWRDYWxsYmFjaygpO1xyXG4gICAgLy8gY29uc29sZS5sb2codGhpcy5zZWxlY3RlZEl0ZW0pXHJcbiAgICB0aGlzLnByb3BhZ2F0ZUNoYW5nZSh0aGlzLnNlbGVjdGVkSXRlbSk7XHJcbiAgICB0aGlzLmNoZWNrRW5hYmxlQ29tU1MoKTtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IGFueSk6IHZvaWQge1xyXG4gICAgdGhpcy5wcm9wYWdhdGVDaGFuZ2UgPSBmbjtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiBhbnkpIHtcclxuICAgIHRoaXMub25Ub3VjaGVkQ2FsbGJhY2sgPSBmbjtcclxuICB9XHJcblxyXG4gIHJlZ2lzdGVyT25WYWxpZGF0b3JDaGFuZ2U/KGZuOiAoKSA9PiB2b2lkKTogdm9pZCB7XHJcbiAgICB0aGlzLnZhbGlkYXRvckNhbGxiYWNrID0gZm47XHJcbiAgfVxyXG5cclxuICAvLyBBbGxvd3MgQW5ndWxhciB0byBkaXNhYmxlIHRoZSBpbnB1dC5cclxuICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xyXG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgdGhpcy5sb29rdXBJbnRlcm5hbE9yZGVyQ29tcG9uZW50Q3RybC5kaXNhYmxlKCk7XHJcbiAgICB9IGVsc2UgeyB0aGlzLmxvb2t1cEludGVybmFsT3JkZXJDb21wb25lbnRDdHJsLmVuYWJsZSgpOyB9XHJcbiAgICB0aGlzLmNoZWNrRW5hYmxlQ29tU1MoKTtcclxuICB9XHJcblxyXG4gIHZhbGlkYXRlKGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbCk6IHsgW2tleTogc3RyaW5nXTogYW55IH0gfCBudWxsIHtcclxuXHJcbiAgICBjb25zdCBpbnRlcm5hbE9yZGVySW5wdXRWYWx1ZSA9IHRoaXMubG9va3VwSW50ZXJuYWxPcmRlckNvbXBvbmVudEN0cmwudmFsdWU7XHJcbiAgICBjb25zdCByZXNwRXJyID0ge30gYXMgSXJlc3BvbnNlRXJyb3I7XHJcblxyXG4gICAgbGV0IGlvdmFsaWQgPSB0cnVlO1xyXG4gICAgbGV0IHNzVmFsaWQgPSB0cnVlO1xyXG5cclxuICAgIC8vIHZhbGlkYXppb25lIGNvbW1lc3NhL2NkY1xyXG4gICAgaWYgKHRoaXMucmVxdWlyZWQgIT09IGZhbHNlKSB7IC8vIG9iYmxpZ2F0b3Jpb1xyXG4gICAgICBpZiAodGhpcy5zZWxlY3RlZEl0ZW0gPT0gbnVsbCB8fCB0aGlzLnNlbGVjdGVkSXRlbS5jb21tZXNzYSA9PSBudWxsKSB7XHJcbiAgICAgICAgcmVzcEVyci5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgaW92YWxpZCA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2UgeyAvLyBub24gb2JibGlnYXRvcmlvXHJcbiAgICAgIGlmICh0eXBlb2YgaW50ZXJuYWxPcmRlcklucHV0VmFsdWUgPT09ICdzdHJpbmcnICYmIGludGVybmFsT3JkZXJJbnB1dFZhbHVlLnRyaW0oKSAhPT0gJycpIHtcclxuICAgICAgICByZXNwRXJyLmludGVybmFsT3JkZXJJbnZhbGlkID0gdHJ1ZTtcclxuICAgICAgICBpb3ZhbGlkID0gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyB2YWxpZGF6aW9uZSBzb3R0b3Npc3RlbWFcclxuICAgIGlmKCF0aGlzLmhpZGVTUyl7XHJcbiAgICAgIGlmICh0aGlzLnJlcXVpcmVkICE9PSBmYWxzZSkgeyAvLyBvYmJsaWdhdG9yaW9cclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEl0ZW0gPT0gbnVsbCB8fCB0aGlzLnNlbGVjdGVkSXRlbS5jb21TUyA9PSBudWxsIHx8IHRoaXMuc2VsZWN0ZWRJdGVtLmNvbVNTLmxlbmd0aCAhPT0gNCkge1xyXG4gICAgICAgICAgcmVzcEVyci5zdWJTeXN0ZW1JbnZhbGlkID0gdHJ1ZTtcclxuICAgICAgICAgIHJlc3BFcnIuc3ViU3lzdGVtUmVxdWlyZWQgPSB0cnVlO1xyXG4gICAgICAgICAgc3NWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHsgLy8gbm9uIG9iYmxpZ2F0b3Jpb1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkSXRlbSAhPSBudWxsICYmIHRoaXMuc2VsZWN0ZWRJdGVtLmNvbVNTICE9IG51bGwgJiZcclxuICAgICAgICAgICAodGhpcy5zZWxlY3RlZEl0ZW0uY29tU1MubGVuZ3RoID4gMCAmJiB0aGlzLnNlbGVjdGVkSXRlbS5jb21TUy5sZW5ndGggIT09IDQpKSB7XHJcbiAgICAgICAgICByZXNwRXJyLnN1YlN5c3RlbUludmFsaWQgPSB0cnVlO1xyXG4gICAgICAgICAgc3NWYWxpZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMudXRpbHMuaW50ZXJuYWxPcmRlclZhbGlkID0gaW92YWxpZDtcclxuICAgIHRoaXMudXRpbHMuc3ViU3lzdGVtVmFsaWQgPSBzc1ZhbGlkO1xyXG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHJlc3BFcnIpLmxlbmd0aCA9PT0gMCA/IG51bGwgOiByZXNwRXJyO1xyXG4gIH1cclxuXHJcbn1cclxuIiwiPGRpdiBjbGFzcz1cImxpby1tZmYtY29udGFpbmVyIGxpby1pby1jb250XCIgPlxyXG4gIDxtYXQtZm9ybS1maWVsZCBbYXBwZWFyYW5jZV09XCJhcHBlYXJhbmNlXCIgIFtuZ0NsYXNzXT1cInsnbGlvX2ZjX2ludmFsaWQnOiAhdXRpbHMuaW50ZXJuYWxPcmRlclZhbGlkfVwiID5cclxuXHJcbiAgICBAaWYoISFsYWJlbCl7XHJcbiAgICAgIDxtYXQtbGFiZWw+e3tsYWJlbH19PC9tYXQtbGFiZWw+XHJcbiAgICB9XHJcbiAgICBAZWxzZSBpZiAoIWhpZGVJTyAmJiAhaGlkZUNkYykge1xyXG4gICAgICAgIDxtYXQtbGFiZWwgaTE4bj1cIkBAbG9va0lPQ2RjX2ludGVybmFsb3JkZXJfY2RjXCIgPldvcmsgT3JkZXIgLyBDREM8L21hdC1sYWJlbD5cclxuICAgICAgfVxyXG4gICAgQGVsc2UgaWYgKGhpZGVJTykge1xyXG4gICAgICAgIDxtYXQtbGFiZWwgaTE4bj1cIkBAbG9va0lPQ2RjX2NkY1wiID5DREM8L21hdC1sYWJlbD5cclxuICAgICAgfVxyXG4gICAgQGVsc2UgaWYgKGhpZGVDZGMpIHtcclxuICAgICAgICA8bWF0LWxhYmVsIGkxOG49XCJAQGxvb2tJT0NkY19pbnRlcm5hbG9yZGVyXCIgPldvcmsgT3JkZXI8L21hdC1sYWJlbD5cclxuICAgICAgfVxyXG4gICAgXHJcblxyXG4gICAgPGlucHV0IG1hdElucHV0IFtyZXF1aXJlZF09XCJyZXF1aXJlZFwiXHJcbiAgICAgIGFyaWEtbGFiZWw9XCJJbnRlcm5hbCBvcmRlciAvIGNkY1wiXHJcbiAgICAgIFttYXRBdXRvY29tcGxldGVdPVwibG9va3VwSW50ZXJuYWxPcmRlckF1dG9jb21wbGV0ZVJlZlwiXHJcbiAgICAgIFtmb3JtQ29udHJvbF09XCJsb29rdXBJbnRlcm5hbE9yZGVyQ29tcG9uZW50Q3RybFwiICA+XHJcbiAgICAgIDxtYXQtYXV0b2NvbXBsZXRlICNsb29rdXBJbnRlcm5hbE9yZGVyQXV0b2NvbXBsZXRlUmVmPVwibWF0QXV0b2NvbXBsZXRlXCIgIFtkaXNwbGF5V2l0aF09XCJkaXNwbGF5Rm5cIiAgY2xhc3M9XCJsaW9BdXRvQ29tcGxldGVcIiAob3B0aW9uU2VsZWN0ZWQpPVwib25TZWxlY3Rpb25DaGFuZ2VkKCRldmVudClcIj5cclxuXHJcbiAgICAgICAgQGlmICghaGlkZUlPKSB7XHJcbiAgICAgICAgICA8bWF0LW9wdGdyb3VwIGxhYmVsPVwiV29yayBPcmRlcnNcIiBpMThuLWxhYmVsPVwiQEBsb29rSU9DZGNfaW50ZXJuYWxvcmRlcnNcIj5cclxuICAgICAgICAgICAgQGZvciAoaW50T3JkIG9mIGludGVybmFsT3JkZXJSZXN0T2JzIHwgYXN5bmM7IHRyYWNrIGludE9yZCkge1xyXG4gICAgICAgICAgICAgIDxtYXQtb3B0aW9uIFt2YWx1ZV09XCJpbnRPcmRcIiBzdHlsZT1cImJvcmRlci1ib3R0b206IDFweCBzb2xpZCBsaWdodGdyYXk7XCJcclxuICAgICAgICAgICAgICAgIFttYXRUb29sdGlwXT1cImludE9yZC5pdGVtSWQgKycgfCAnICtpbnRPcmQuaXRlbURlc2NyaXB0aW9uXCIgbWF0VG9vbHRpcFNob3dEZWxheT0xMDAwPlxyXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zXCI+XHJcbiAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwibGlvQXV0b2NvbXBsZXRlSXRlbXNJZFwiPnt7aW50T3JkLml0ZW1JZH19PC9zcGFuPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zRGVzY3JcIj57e2ludE9yZC5pdGVtRGVzY3JpcHRpb259fTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgIDwvbWF0LW9wdGlvbj5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgPC9tYXQtb3B0Z3JvdXA+XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBAaWYgKCFoaWRlQ2RjKSB7XHJcbiAgICAgICAgICA8bWF0LW9wdGdyb3VwIGxhYmVsPVwiQ0RDXCIgaTE4bi1sYWJlbD1cIkBAbG9va0lPQ2RjX2NkY1wiPlxyXG4gICAgICAgICAgICBAZm9yIChpbnRPcmQgb2YgY2RjUmVzdE9icyB8IGFzeW5jOyB0cmFjayBpbnRPcmQpIHtcclxuICAgICAgICAgICAgICA8bWF0LW9wdGlvbiBbdmFsdWVdPVwiaW50T3JkXCIgc3R5bGU9XCJib3JkZXItYm90dG9tOiAxcHggc29saWQgbGlnaHRncmF5O1wiXHJcbiAgICAgICAgICAgICAgICBbbWF0VG9vbHRpcF09XCJpbnRPcmQuaXRlbUlkICsnIHwgJyAraW50T3JkLml0ZW1EZXNjcmlwdGlvblwiIG1hdFRvb2x0aXBTaG93RGVsYXk9MTAwMD5cclxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsaW9BdXRvY29tcGxldGVJdGVtc1wiPlxyXG4gICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zSWRcIj57e2ludE9yZC5pdGVtSWR9fTwvc3Bhbj5cclxuICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJsaW9BdXRvY29tcGxldGVJdGVtc0Rlc2NyXCI+e3tpbnRPcmQuaXRlbURlc2NyaXB0aW9ufX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICA8L21hdC1vcHRpb24+XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIDwvbWF0LW9wdGdyb3VwPlxyXG4gICAgICAgIH1cclxuICAgICAgPC9tYXQtYXV0b2NvbXBsZXRlPlxyXG5cclxuICAgICAgQGlmIChzZWxlY3RlZEl0ZW0hPXVuZGVmaW5lZCkge1xyXG4gICAgICAgIDxtYXQtaGludCBjbGFzcz1cImxpb0hpbnRcIiAgW21hdFRvb2x0aXBdPVwic2VsZWN0ZWRJdGVtLmNvbW1lc3NhRGVzY3JpemlvbmVcIiA+e3tzZWxlY3RlZEl0ZW0uY29tbWVzc2FEZXNjcml6aW9uZX19PC9tYXQtaGludD5cclxuICAgICAgfVxyXG4gICAgICA8bWF0LWljb24gW3N0eWxlLnZpc2liaWxpdHldPVwiIShkaXNhYmxlZCE9PWZhbHNlKSA/ICdpbml0aWFsJyA6ICdoaWRkZW4nXCIgc3R5bGU9XCJjdXJzb3I6IHBvaW50ZXI7XCIgbWF0U3VmZml4IChjbGljayk9XCJzZWFyY2hQb3B1cCgpOyRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcIj5zZWFyY2g8L21hdC1pY29uPlxyXG4gICAgPC9tYXQtZm9ybS1maWVsZD5cclxuICAgIEBpZiAodXRpbHMuaW9Mb2FkaW5nSW5Qcm9ncmVzcyB8fCB1dGlscy5jZGNMb2FkaW5nSW5Qcm9ncmVzcykge1xyXG4gICAgICA8bWF0LXByb2dyZXNzLWJhciBjbGFzcz1cImxpb1Byb2dyZXNzQmFyXCIgbW9kZT1cInF1ZXJ5XCI+PC9tYXQtcHJvZ3Jlc3MtYmFyPlxyXG4gICAgfVxyXG4gIDwvZGl2PlxyXG5cclxuXHJcblxyXG5cclxuICBAaWYoIWhpZGVTUyl7XHJcbiAgPGRpdiBjbGFzcz1cImxpby1tZmYtY29udGFpbmVyXCI+XHJcbiAgICA8bWF0LWZvcm0tZmllbGQgW2FwcGVhcmFuY2VdPVwiYXBwZWFyYW5jZVwiICAgIFtuZ0NsYXNzXT1cInsnbGlvX2ZjX2ludmFsaWQnOiAhdXRpbHMuc3ViU3lzdGVtVmFsaWR9XCIgPlxyXG4gICAgICA8bWF0LWxhYmVsIGkxOG49XCJAQGxvb2tJT0NkY19zdWJzeXN0ZW1cIiA+U3ViIFN5c3RlbTwvbWF0LWxhYmVsPlxyXG4gICAgICA8aW5wdXQgbWF0SW5wdXQgW3JlcXVpcmVkXT1cInJlcXVpcmVkXCJcclxuICAgICAgICBhcmlhLWxhYmVsPVwiU3ViIFN5c3RlbVwiXHJcbiAgICAgICAgW21hdEF1dG9jb21wbGV0ZV09XCJsb29rdXBTdWJTeXN0ZW1BdXRvY29tcGxldGVSZWZcIlxyXG4gICAgICAgIFtmb3JtQ29udHJvbF09XCJsb29rdXBTdWJTeXN0ZW1Db21wb25lbnRDdHJsXCIgID5cclxuXHJcbiAgICAgICAgPG1hdC1hdXRvY29tcGxldGUgI2xvb2t1cFN1YlN5c3RlbUF1dG9jb21wbGV0ZVJlZj1cIm1hdEF1dG9jb21wbGV0ZVwiICAgIGNsYXNzPVwibGlvQXV0b0NvbXBsZXRlXCIgW2Rpc3BsYXlXaXRoXT1cImRpc3BsYXlDb21TU0ZuXCIgKG9wdGlvblNlbGVjdGVkKT1cIm9uQ29tU1NTZWxlY3Rpb25DaGFuZ2VkKCRldmVudClcIj5cclxuICAgICAgICAgIEBmb3IgKGNvbXNzIG9mIHN1YlN5c3RlbURhdGFPYnMgfCBhc3luYzsgdHJhY2sgY29tc3MpIHtcclxuICAgICAgICAgICAgPG1hdC1vcHRpb24gW3ZhbHVlXT1cImNvbXNzXCJcclxuICAgICAgICAgICAgICBbbWF0VG9vbHRpcF09XCJjb21zcy5jb21TUyArJyB8ICcgK2NvbXNzLmNvbVNTRGVzY3JpcHRpb25cIiBtYXRUb29sdGlwU2hvd0RlbGF5PTEwMDA+XHJcbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zXCI+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zSWRcIj57e2NvbXNzLmNvbVNTfX08L3NwYW4+XHJcbiAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cImxpb0F1dG9jb21wbGV0ZUl0ZW1zRGVzY3JcIj57e2NvbXNzLmNvbVNTRGVzY3JpcHRpb259fTwvc3Bhbj5cclxuICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgPC9tYXQtb3B0aW9uPlxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIDwvbWF0LWF1dG9jb21wbGV0ZT5cclxuICAgICAgICBAaWYgKHNlbGVjdGVkSXRlbSE9dW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICA8bWF0LWhpbnQgY2xhc3M9XCJsaW9IaW50XCIgIFttYXRUb29sdGlwXT1cInNlbGVjdGVkSXRlbS5jb21TU0Rlc2NyaXppb25lXCIgPnt7c2VsZWN0ZWRJdGVtLmNvbVNTRGVzY3JpemlvbmV9fTwvbWF0LWhpbnQ+XHJcbiAgICAgICAgfVxyXG4gICAgICA8L21hdC1mb3JtLWZpZWxkPlxyXG4gICAgICBAaWYgKHV0aWxzLnN1YnN5c3RlbUxvYWRpbmdJblByb2dyZXNzKSB7XHJcbiAgICAgICAgPG1hdC1wcm9ncmVzcy1iYXIgY2xhc3M9XCJsaW9Qcm9ncmVzc0JhclwiIG1vZGU9XCJxdWVyeVwiPjwvbWF0LXByb2dyZXNzLWJhcj5cclxuICAgICAgfVxyXG4gICAgPC9kaXY+XHJcbiAgfSJdfQ==