import { Component, Inject, ViewChild } from '@angular/core';
import { UntypedFormControl, FormsModule, ReactiveFormsModule } from '@angular/forms';
import { MAT_DIALOG_DATA, MatDialogContent, MatDialogActions, MatDialogClose } from '@angular/material/dialog';
import { MatPaginator } from '@angular/material/paginator';
import { MatSort, MatSortHeader } from '@angular/material/sort';
import { MatTableDataSource, MatTable, MatColumnDef, MatHeaderCellDef, MatHeaderCell, MatCellDef, MatCell, MatHeaderRowDef, MatHeaderRow, MatRowDef, MatRow } from '@angular/material/table';
import { merge } from 'rxjs';
import { debounceTime, startWith, switchMap } from 'rxjs/operators';
import { MatButton } from '@angular/material/button';
import { MatInput } from '@angular/material/input';
import { MatFormField } from '@angular/material/form-field';
import { CdkScrollable } from '@angular/cdk/scrolling';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/dialog";
import * as i2 from "../../../../../sii-toolkit.service";
import * as i3 from "@angular/common/http";
import * as i4 from "@angular/forms";
export class SearchOdaPosDialogComponent {
    constructor(dialogRef, siiToolkitService, http, data) {
        this.dialogRef = dialogRef;
        this.siiToolkitService = siiToolkitService;
        this.http = http;
        this.data = data;
        this.odaposFormControl = new UntypedFormControl();
        this.odaposDisplayedColumns = ['oda', 'pos'];
        this.odaposResultsLength = 0;
    }
    ngAfterViewInit() {
        this.odaposSort.sortChange.subscribe(() => this.odaposPaginator.firstPage());
        this.odaposFormControl.valueChanges.subscribe(() => this.odaposPaginator.firstPage());
        merge(this.odaposSort.sortChange, this.odaposPaginator.page, this.odaposFormControl.valueChanges).pipe(startWith({}), debounceTime(500), switchMap((data) => {
            return this.fetchOdaposDataFromServer();
        })).subscribe((resp) => {
            this.updateOdaposData(resp);
        });
    }
    updateOdaposData(data) {
        this.odaposDataSource = new MatTableDataSource(data.content);
        this.odaposResultsLength = data.totalElements;
    }
    fetchOdaposDataFromServer() {
        return this.http.post(`${this.siiToolkitService.environment.domain}/lookup/oda`, {
            text: this.odaposFormControl.value,
            codSociety: this.data.codSociety,
            codSupplier: this.data.codSupplier,
            lavMatricola: this.data.lavMatricola,
            tipologie: this.data.tipologie,
            page: this.odaposPaginator.pageIndex,
            size: this.odaposPaginator.pageSize,
            sortField: this.odaposSort.active,
            sortDirection: this.odaposSort.direction.toUpperCase(),
        });
    }
    selectOdaposRow(row, event) {
        if (event.view.getSelection().type !== 'Range') {
            this.dialogRef.close(row);
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: SearchOdaPosDialogComponent, deps: [{ token: i1.MatDialogRef }, { token: i2.SiiToolkitService }, { token: i3.HttpClient }, { token: MAT_DIALOG_DATA }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.2.13", type: SearchOdaPosDialogComponent, isStandalone: true, selector: "sii-search-oda-pos-dialog", viewQueries: [{ propertyName: "odaposPaginator", first: true, predicate: ["odaposPaginator"], descendants: true, read: MatPaginator, static: true }, { propertyName: "odaposSort", first: true, predicate: ["odaposSort"], descendants: true, read: MatSort, static: true }], ngImport: i0, template: "\r\n<div mat-dialog-content>\r\n    <mat-form-field>\r\n        <input matInput [formControl]=\"odaposFormControl\"  placeholder=\"Filter\" i18n-placeholder=\"@@siodialog_Filter\">\r\n      </mat-form-field>\r\n\r\n      <div class=\"siod_tableContainer\">\r\n        <table mat-table [dataSource]=\"odaposDataSource\" class=\"mat-elevation-z8\"\r\n        matSort matSortActive=\"oda\" matSortDisableClear matSortDirection=\"desc\" #odaposSort>\r\n\r\n          <!-- itemId Column -->\r\n          <ng-container matColumnDef=\"oda\">\r\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"ITEM_ID\" i18n=\"@@oda\">Oda</th>\r\n            <td mat-cell *matCellDef=\"let element\"> {{element.oda}} </td>\r\n          </ng-container>\r\n\r\n          <!-- itemDescription Column -->\r\n          <ng-container matColumnDef=\"pos\">\r\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"ITEM_DESCRIPTION\" > Pos </th>\r\n            <td mat-cell *matCellDef=\"let element\"> {{element.pos}} </td>\r\n          </ng-container>\r\n\r\n\r\n          <tr mat-header-row *matHeaderRowDef=\"odaposDisplayedColumns;sticky: true\"></tr>\r\n          <tr mat-row *matRowDef=\"let row; columns: odaposDisplayedColumns;\" (click)=\"selectOdaposRow(row,$event)\" ></tr>\r\n        </table>\r\n\r\n      </div>\r\n\r\n        <mat-paginator #odaposPaginator [length]=\"odaposResultsLength\" [pageSize]=\"10\" [pageSizeOptions]=\"[5, 10, 20]\"></mat-paginator>\r\n\r\n  </div>\r\n  <div mat-dialog-actions style=\"float:right\">\r\n    <button mat-button class=\"sii-button-light\" [mat-dialog-close] i18n=\"@@siodialog_cancel_button\">Cancel Operation</button>\r\n  </div>\r\n", styles: [""], dependencies: [{ kind: "directive", type: MatDialogContent, selector: "[mat-dialog-content], mat-dialog-content, [matDialogContent]" }, { kind: "component", type: MatFormField, selector: "mat-form-field", inputs: ["hideRequiredMarker", "color", "floatLabel", "appearance", "subscriptSizing", "hintLabel"], exportAs: ["matFormField"] }, { kind: "directive", type: MatInput, selector: "input[matInput], textarea[matInput], select[matNativeControl],      input[matNativeControl], textarea[matNativeControl]", inputs: ["disabled", "id", "placeholder", "name", "required", "type", "errorStateMatcher", "aria-describedby", "value", "readonly"], exportAs: ["matInput"] }, { kind: "ngmodule", type: FormsModule }, { kind: "directive", type: i4.DefaultValueAccessor, selector: "input:not([type=checkbox])[formControlName],textarea[formControlName],input:not([type=checkbox])[formControl],textarea[formControl],input:not([type=checkbox])[ngModel],textarea[ngModel],[ngDefaultControl]" }, { kind: "directive", type: i4.NgControlStatus, selector: "[formControlName],[ngModel],[formControl]" }, { kind: "ngmodule", type: ReactiveFormsModule }, { kind: "directive", type: i4.FormControlDirective, selector: "[formControl]", inputs: ["formControl", "disabled", "ngModel"], outputs: ["ngModelChange"], exportAs: ["ngForm"] }, { kind: "component", type: MatTable, selector: "mat-table, table[mat-table]", exportAs: ["matTable"] }, { kind: "directive", type: MatSort, selector: "[matSort]", inputs: ["matSortActive", "matSortStart", "matSortDirection", "matSortDisableClear", "matSortDisabled"], outputs: ["matSortChange"], exportAs: ["matSort"] }, { kind: "directive", type: MatColumnDef, selector: "[matColumnDef]", inputs: ["matColumnDef"] }, { kind: "directive", type: MatHeaderCellDef, selector: "[matHeaderCellDef]" }, { kind: "directive", type: MatHeaderCell, selector: "mat-header-cell, th[mat-header-cell]" }, { kind: "component", type: MatSortHeader, selector: "[mat-sort-header]", inputs: ["mat-sort-header", "arrowPosition", "start", "disabled", "sortActionDescription", "disableClear"], exportAs: ["matSortHeader"] }, { kind: "directive", type: MatCellDef, selector: "[matCellDef]" }, { kind: "directive", type: MatCell, selector: "mat-cell, td[mat-cell]" }, { kind: "directive", type: MatHeaderRowDef, selector: "[matHeaderRowDef]", inputs: ["matHeaderRowDef", "matHeaderRowDefSticky"] }, { kind: "component", type: MatHeaderRow, selector: "mat-header-row, tr[mat-header-row]", exportAs: ["matHeaderRow"] }, { kind: "directive", type: MatRowDef, selector: "[matRowDef]", inputs: ["matRowDefColumns", "matRowDefWhen"] }, { kind: "component", type: MatRow, selector: "mat-row, tr[mat-row]", exportAs: ["matRow"] }, { kind: "component", type: MatPaginator, selector: "mat-paginator", inputs: ["color", "pageIndex", "length", "pageSize", "pageSizeOptions", "hidePageSize", "showFirstLastButtons", "selectConfig", "disabled"], outputs: ["page"], exportAs: ["matPaginator"] }, { kind: "directive", type: MatDialogActions, selector: "[mat-dialog-actions], mat-dialog-actions, [matDialogActions]", inputs: ["align"] }, { kind: "component", type: MatButton, selector: "    button[mat-button], button[mat-raised-button], button[mat-flat-button],    button[mat-stroked-button]  ", exportAs: ["matButton"] }, { kind: "directive", type: MatDialogClose, selector: "[mat-dialog-close], [matDialogClose]", inputs: ["aria-label", "type", "mat-dialog-close", "matDialogClose"], exportAs: ["matDialogClose"] }] }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.13", ngImport: i0, type: SearchOdaPosDialogComponent, decorators: [{
            type: Component,
            args: [{ selector: 'sii-search-oda-pos-dialog', standalone: true, imports: [
                        CdkScrollable,
                        MatDialogContent,
                        MatFormField,
                        MatInput,
                        FormsModule,
                        ReactiveFormsModule,
                        MatTable,
                        MatSort,
                        MatColumnDef,
                        MatHeaderCellDef,
                        MatHeaderCell,
                        MatSortHeader,
                        MatCellDef,
                        MatCell,
                        MatHeaderRowDef,
                        MatHeaderRow,
                        MatRowDef,
                        MatRow,
                        MatPaginator,
                        MatDialogActions,
                        MatButton,
                        MatDialogClose,
                    ], template: "\r\n<div mat-dialog-content>\r\n    <mat-form-field>\r\n        <input matInput [formControl]=\"odaposFormControl\"  placeholder=\"Filter\" i18n-placeholder=\"@@siodialog_Filter\">\r\n      </mat-form-field>\r\n\r\n      <div class=\"siod_tableContainer\">\r\n        <table mat-table [dataSource]=\"odaposDataSource\" class=\"mat-elevation-z8\"\r\n        matSort matSortActive=\"oda\" matSortDisableClear matSortDirection=\"desc\" #odaposSort>\r\n\r\n          <!-- itemId Column -->\r\n          <ng-container matColumnDef=\"oda\">\r\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"ITEM_ID\" i18n=\"@@oda\">Oda</th>\r\n            <td mat-cell *matCellDef=\"let element\"> {{element.oda}} </td>\r\n          </ng-container>\r\n\r\n          <!-- itemDescription Column -->\r\n          <ng-container matColumnDef=\"pos\">\r\n            <th mat-header-cell *matHeaderCellDef mat-sort-header=\"ITEM_DESCRIPTION\" > Pos </th>\r\n            <td mat-cell *matCellDef=\"let element\"> {{element.pos}} </td>\r\n          </ng-container>\r\n\r\n\r\n          <tr mat-header-row *matHeaderRowDef=\"odaposDisplayedColumns;sticky: true\"></tr>\r\n          <tr mat-row *matRowDef=\"let row; columns: odaposDisplayedColumns;\" (click)=\"selectOdaposRow(row,$event)\" ></tr>\r\n        </table>\r\n\r\n      </div>\r\n\r\n        <mat-paginator #odaposPaginator [length]=\"odaposResultsLength\" [pageSize]=\"10\" [pageSizeOptions]=\"[5, 10, 20]\"></mat-paginator>\r\n\r\n  </div>\r\n  <div mat-dialog-actions style=\"float:right\">\r\n    <button mat-button class=\"sii-button-light\" [mat-dialog-close] i18n=\"@@siodialog_cancel_button\">Cancel Operation</button>\r\n  </div>\r\n" }]
        }], ctorParameters: () => [{ type: i1.MatDialogRef }, { type: i2.SiiToolkitService }, { type: i3.HttpClient }, { type: undefined, decorators: [{
                    type: Inject,
                    args: [MAT_DIALOG_DATA]
                }] }], propDecorators: { odaposPaginator: [{
                type: ViewChild,
                args: ['odaposPaginator', { read: MatPaginator, static: true }]
            }], odaposSort: [{
                type: ViewChild,
                args: ['odaposSort', { read: MatSort, static: true }]
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLW9kYS1wb3MtZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3NpaS10b29sa2l0L3NyYy9saWIvY29tcG9uZW50cy9kc2lpLWNvbXBvbmVudHMvbG9va3VwLW9kYS1wb3MvY29tcG9uZW50cy9zZWFyY2gtb2RhLXBvcy1kaWFsb2cvc2VhcmNoLW9kYS1wb3MtZGlhbG9nLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL3NpaS10b29sa2l0L3NyYy9saWIvY29tcG9uZW50cy9kc2lpLWNvbXBvbmVudHMvbG9va3VwLW9kYS1wb3MvY29tcG9uZW50cy9zZWFyY2gtb2RhLXBvcy1kaWFsb2cvc2VhcmNoLW9kYS1wb3MtZGlhbG9nLmNvbXBvbmVudC5odG1sIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNBLE9BQU8sRUFBaUIsU0FBUyxFQUFFLE1BQU0sRUFBVSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDcEYsT0FBTyxFQUFFLGtCQUFrQixFQUFFLFdBQVcsRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3RGLE9BQU8sRUFBRSxlQUFlLEVBQWdCLGdCQUFnQixFQUFFLGdCQUFnQixFQUFFLGNBQWMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQzdILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSw2QkFBNkIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxRQUFRLEVBQUUsWUFBWSxFQUFFLGdCQUFnQixFQUFFLGFBQWEsRUFBRSxVQUFVLEVBQUUsT0FBTyxFQUFFLGVBQWUsRUFBRSxZQUFZLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQzdM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QUFsRixTQUFTO3VCQUFDLGlCQUFpQixFQUFFLEVBQUUsSUFBSSxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO2dCQUNSLFVBQVU7c0JBQW5FLFNBQVM7dUJBQUMsWUFBWSxFQUFFLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcclxuaW1wb3J0IHsgQWZ0ZXJWaWV3SW5pdCwgQ29tcG9uZW50LCBJbmplY3QsIE9uSW5pdCwgVmlld0NoaWxkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IFVudHlwZWRGb3JtQ29udHJvbCwgRm9ybXNNb2R1bGUsIFJlYWN0aXZlRm9ybXNNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XHJcbmltcG9ydCB7IE1BVF9ESUFMT0dfREFUQSwgTWF0RGlhbG9nUmVmLCBNYXREaWFsb2dDb250ZW50LCBNYXREaWFsb2dBY3Rpb25zLCBNYXREaWFsb2dDbG9zZSB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XHJcbmltcG9ydCB7IE1hdFBhZ2luYXRvciB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL3BhZ2luYXRvcic7XHJcbmltcG9ydCB7IE1hdFNvcnQsIE1hdFNvcnRIZWFkZXIgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9zb3J0JztcclxuaW1wb3J0IHsgTWF0VGFibGVEYXRhU291cmNlLCBNYXRUYWJsZSwgTWF0Q29sdW1uRGVmLCBNYXRIZWFkZXJDZWxsRGVmLCBNYXRIZWFkZXJDZWxsLCBNYXRDZWxsRGVmLCBNYXRDZWxsLCBNYXRIZWFkZXJSb3dEZWYsIE1hdEhlYWRlclJvdywgTWF0Um93RGVmLCBNYXRSb3cgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC90YWJsZSc7XHJcbmltcG9ydCB7IG1lcmdlLCBPYnNlcnZhYmxlSW5wdXQgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgZGVib3VuY2VUaW1lLCBzdGFydFdpdGgsIHN3aXRjaE1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcclxuaW1wb3J0IHsgSUxvb2t1cE9kYURhdGFEVE8gfSBmcm9tICcuLi8uLi9kb21haW4vbG9va3VwLW9kYS1kYXRhLmR0byc7XHJcbmltcG9ydCB7IElQYWdlYWJsZUxvb2t1cE9kYVBvc0RhdGFEVE8gfSBmcm9tICcuLi8uLi9kb21haW4vcGFnZWFibGUtbG9va3VwLW9kYS1wb3MtZGF0YS5kdG8nO1xyXG5pbXBvcnQgeyBTaWlUb29sa2l0U2VydmljZSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL3NpaS10b29sa2l0LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBNYXRCdXR0b24gfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9idXR0b24nO1xyXG5pbXBvcnQgeyBNYXRJbnB1dCB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2lucHV0JztcclxuaW1wb3J0IHsgTWF0Rm9ybUZpZWxkIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZm9ybS1maWVsZCc7XHJcbmltcG9ydCB7IENka1Njcm9sbGFibGUgfSBmcm9tICdAYW5ndWxhci9jZGsvc2Nyb2xsaW5nJztcclxuQENvbXBvbmVudCh7XHJcbiAgICBzZWxlY3RvcjogJ3NpaS1zZWFyY2gtb2RhLXBvcy1kaWFsb2cnLFxyXG4gICAgdGVtcGxhdGVVcmw6ICcuL3NlYXJjaC1vZGEtcG9zLWRpYWxvZy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICBzdHlsZVVybHM6IFsnLi9zZWFyY2gtb2RhLXBvcy1kaWFsb2cuY29tcG9uZW50LmNzcyddLFxyXG4gICAgc3RhbmRhbG9uZTogdHJ1ZSxcclxuICAgIGltcG9ydHM6IFtcclxuICAgICAgICBDZGtTY3JvbGxhYmxlLFxyXG4gICAgICAgIE1hdERpYWxvZ0NvbnRlbnQsXHJcbiAgICAgICAgTWF0Rm9ybUZpZWxkLFxyXG4gICAgICAgIE1hdElucHV0LFxyXG4gICAgICAgIEZvcm1zTW9kdWxlLFxyXG4gICAgICAgIFJlYWN0aXZlRm9ybXNNb2R1bGUsXHJcbiAgICAgICAgTWF0VGFibGUsXHJcbiAgICAgICAgTWF0U29ydCxcclxuICAgICAgICBNYXRDb2x1bW5EZWYsXHJcbiAgICAgICAgTWF0SGVhZGVyQ2VsbERlZixcclxuICAgICAgICBNYXRIZWFkZXJDZWxsLFxyXG4gICAgICAgIE1hdFNvcnRIZWFkZXIsXHJcbiAgICAgICAgTWF0Q2VsbERlZixcclxuICAgICAgICBNYXRDZWxsLFxyXG4gICAgICAgIE1hdEhlYWRlclJvd0RlZixcclxuICAgICAgICBNYXRIZWFkZXJSb3csXHJcbiAgICAgICAgTWF0Um93RGVmLFxyXG4gICAgICAgIE1hdFJvdyxcclxuICAgICAgICBNYXRQYWdpbmF0b3IsXHJcbiAgICAgICAgTWF0RGlhbG9nQWN0aW9ucyxcclxuICAgICAgICBNYXRCdXR0b24sXHJcbiAgICAgICAgTWF0RGlhbG9nQ2xvc2UsXHJcbiAgICBdLFxyXG59KVxyXG5leHBvcnQgY2xhc3MgU2VhcmNoT2RhUG9zRGlhbG9nQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCB7XHJcbiAgQFZpZXdDaGlsZCgnb2RhcG9zUGFnaW5hdG9yJywgeyByZWFkOiBNYXRQYWdpbmF0b3IsIHN0YXRpYzogdHJ1ZSB9KSBvZGFwb3NQYWdpbmF0b3I6IE1hdFBhZ2luYXRvcjtcclxuICBAVmlld0NoaWxkKCdvZGFwb3NTb3J0JywgeyByZWFkOiBNYXRTb3J0LCBzdGF0aWM6IHRydWUgfSkgb2RhcG9zU29ydDogTWF0U29ydDtcclxuXHJcbiAgb2RhcG9zRm9ybUNvbnRyb2wgPSBuZXcgVW50eXBlZEZvcm1Db250cm9sKCk7XHJcbiAgb2RhcG9zRGlzcGxheWVkQ29sdW1uczogc3RyaW5nW10gPSBbJ29kYScsICdwb3MnXTtcclxuICBvZGFwb3NEYXRhU291cmNlOiBNYXRUYWJsZURhdGFTb3VyY2U8SUxvb2t1cE9kYURhdGFEVE8+O1xyXG4gIG9kYXBvc1Jlc3VsdHNMZW5ndGggPSAwO1xyXG5cclxuICBjb25zdHJ1Y3RvcihwdWJsaWMgZGlhbG9nUmVmOiBNYXREaWFsb2dSZWY8U2VhcmNoT2RhUG9zRGlhbG9nQ29tcG9uZW50PixwdWJsaWMgc2lpVG9vbGtpdFNlcnZpY2U6IFNpaVRvb2xraXRTZXJ2aWNlLFxyXG4gICAgICAgICAgICAgIHB1YmxpYyBodHRwOiBIdHRwQ2xpZW50LCBASW5qZWN0KE1BVF9ESUFMT0dfREFUQSkgcHVibGljIGRhdGE6IElTZWFyY2hPZGFQb3NEaWFsb2dDb21wb25lbnREYXRhKSB7IH1cclxuXHJcbiAgbmdBZnRlclZpZXdJbml0KCkge1xyXG4gICAgdGhpcy5vZGFwb3NTb3J0LnNvcnRDaGFuZ2Uuc3Vic2NyaWJlKCgpID0+IHRoaXMub2RhcG9zUGFnaW5hdG9yLmZpcnN0UGFnZSgpKTtcclxuICAgIHRoaXMub2RhcG9zRm9ybUNvbnRyb2wudmFsdWVDaGFuZ2VzLnN1YnNjcmliZSgoKSA9PiB0aGlzLm9kYXBvc1BhZ2luYXRvci5maXJzdFBhZ2UoKSk7XHJcblxyXG4gICAgbWVyZ2UodGhpcy5vZGFwb3NTb3J0LnNvcnRDaGFuZ2UsIHRoaXMub2RhcG9zUGFnaW5hdG9yLnBhZ2UsIHRoaXMub2RhcG9zRm9ybUNvbnRyb2wudmFsdWVDaGFuZ2VzKS5waXBlKFxyXG4gICAgICAgIHN0YXJ0V2l0aCh7fSksXHJcbiAgICAgICAgZGVib3VuY2VUaW1lKDUwMCksXHJcbiAgICAgICAgc3dpdGNoTWFwKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaE9kYXBvc0RhdGFGcm9tU2VydmVyKCk7XHJcbiAgICAgICAgfSksXHJcbiAgICAgICkuc3Vic2NyaWJlKChyZXNwKSA9PiB7XHJcbiAgICAgICAgdGhpcy51cGRhdGVPZGFwb3NEYXRhKHJlc3ApO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgdXBkYXRlT2RhcG9zRGF0YShkYXRhOiBJUGFnZWFibGVMb29rdXBPZGFQb3NEYXRhRFRPKSB7XHJcbiAgICB0aGlzLm9kYXBvc0RhdGFTb3VyY2UgPSBuZXcgTWF0VGFibGVEYXRhU291cmNlKGRhdGEuY29udGVudCk7XHJcbiAgICB0aGlzLm9kYXBvc1Jlc3VsdHNMZW5ndGggPSBkYXRhLnRvdGFsRWxlbWVudHM7XHJcbiAgfVxyXG4gIGZldGNoT2RhcG9zRGF0YUZyb21TZXJ2ZXIoKTogT2JzZXJ2YWJsZUlucHV0PElQYWdlYWJsZUxvb2t1cE9kYVBvc0RhdGFEVE8+IHtcclxuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdDxJUGFnZWFibGVMb29rdXBPZGFQb3NEYXRhRFRPPihgJHt0aGlzLnNpaVRvb2xraXRTZXJ2aWNlLmVudmlyb25tZW50LmRvbWFpbn0vbG9va3VwL29kYWAsXHJcbiAgICAgIHtcclxuICAgICAgICB0ZXh0OiB0aGlzLm9kYXBvc0Zvcm1Db250cm9sLnZhbHVlLFxyXG4gICAgICAgIGNvZFNvY2lldHk6IHRoaXMuZGF0YS5jb2RTb2NpZXR5LFxyXG4gICAgICAgIGNvZFN1cHBsaWVyOiB0aGlzLmRhdGEuY29kU3VwcGxpZXIsXHJcbiAgICAgICAgbGF2TWF0cmljb2xhOiB0aGlzLmRhdGEubGF2TWF0cmljb2xhLFxyXG4gICAgICAgIHRpcG9sb2dpZTogdGhpcy5kYXRhLnRpcG9sb2dpZSxcclxuXHJcbiAgICAgICAgcGFnZTogdGhpcy5vZGFwb3NQYWdpbmF0b3IucGFnZUluZGV4LFxyXG4gICAgICAgIHNpemU6IHRoaXMub2RhcG9zUGFnaW5hdG9yLnBhZ2VTaXplLFxyXG4gICAgICAgIHNvcnRGaWVsZDogdGhpcy5vZGFwb3NTb3J0LmFjdGl2ZSxcclxuICAgICAgICBzb3J0RGlyZWN0aW9uOiB0aGlzLm9kYXBvc1NvcnQuZGlyZWN0aW9uLnRvVXBwZXJDYXNlKCksXHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2VsZWN0T2RhcG9zUm93KHJvdzogSUxvb2t1cE9kYURhdGFEVE8sIGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQudmlldy5nZXRTZWxlY3Rpb24oKS50eXBlICE9PSAnUmFuZ2UnKSB7XHJcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKHJvdyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5cclxuaW50ZXJmYWNlIElTZWFyY2hPZGFQb3NEaWFsb2dDb21wb25lbnREYXRhIHtcclxuICBjb2RTb2NpZXR5OiBzdHJpbmc7XHJcbiAgY29kU3VwcGxpZXI6IHN0cmluZztcclxuICBsYXZNYXRyaWNvbGE6IHN0cmluZztcclxuICB0aXBvbG9naWU6IHN0cmluZztcclxufVxyXG4iLCJcclxuPGRpdiBtYXQtZGlhbG9nLWNvbnRlbnQ+XHJcbiAgICA8bWF0LWZvcm0tZmllbGQ+XHJcbiAgICAgICAgPGlucHV0IG1hdElucHV0IFtmb3JtQ29udHJvbF09XCJvZGFwb3NGb3JtQ29udHJvbFwiICBwbGFjZWhvbGRlcj1cIkZpbHRlclwiIGkxOG4tcGxhY2Vob2xkZXI9XCJAQHNpb2RpYWxvZ19GaWx0ZXJcIj5cclxuICAgICAgPC9tYXQtZm9ybS1maWVsZD5cclxuXHJcbiAgICAgIDxkaXYgY2xhc3M9XCJzaW9kX3RhYmxlQ29udGFpbmVyXCI+XHJcbiAgICAgICAgPHRhYmxlIG1hdC10YWJsZSBbZGF0YVNvdXJjZV09XCJvZGFwb3NEYXRhU291cmNlXCIgY2xhc3M9XCJtYXQtZWxldmF0aW9uLXo4XCJcclxuICAgICAgICBtYXRTb3J0IG1hdFNvcnRBY3RpdmU9XCJvZGFcIiBtYXRTb3J0RGlzYWJsZUNsZWFyIG1hdFNvcnREaXJlY3Rpb249XCJkZXNjXCIgI29kYXBvc1NvcnQ+XHJcblxyXG4gICAgICAgICAgPCEtLSBpdGVtSWQgQ29sdW1uIC0tPlxyXG4gICAgICAgICAgPG5nLWNvbnRhaW5lciBtYXRDb2x1bW5EZWY9XCJvZGFcIj5cclxuICAgICAgICAgICAgPHRoIG1hdC1oZWFkZXItY2VsbCAqbWF0SGVhZGVyQ2VsbERlZiBtYXQtc29ydC1oZWFkZXI9XCJJVEVNX0lEXCIgaTE4bj1cIkBAb2RhXCI+T2RhPC90aD5cclxuICAgICAgICAgICAgPHRkIG1hdC1jZWxsICptYXRDZWxsRGVmPVwibGV0IGVsZW1lbnRcIj4ge3tlbGVtZW50Lm9kYX19IDwvdGQ+XHJcbiAgICAgICAgICA8L25nLWNvbnRhaW5lcj5cclxuXHJcbiAgICAgICAgICA8IS0tIGl0ZW1EZXNjcmlwdGlvbiBDb2x1bW4gLS0+XHJcbiAgICAgICAgICA8bmctY29udGFpbmVyIG1hdENvbHVtbkRlZj1cInBvc1wiPlxyXG4gICAgICAgICAgICA8dGggbWF0LWhlYWRlci1jZWxsICptYXRIZWFkZXJDZWxsRGVmIG1hdC1zb3J0LWhlYWRlcj1cIklURU1fREVTQ1JJUFRJT05cIiA+IFBvcyA8L3RoPlxyXG4gICAgICAgICAgICA8dGQgbWF0LWNlbGwgKm1hdENlbGxEZWY9XCJsZXQgZWxlbWVudFwiPiB7e2VsZW1lbnQucG9zfX0gPC90ZD5cclxuICAgICAgICAgIDwvbmctY29udGFpbmVyPlxyXG5cclxuXHJcbiAgICAgICAgICA8dHIgbWF0LWhlYWRlci1yb3cgKm1hdEhlYWRlclJvd0RlZj1cIm9kYXBvc0Rpc3BsYXllZENvbHVtbnM7c3RpY2t5OiB0cnVlXCI+PC90cj5cclxuICAgICAgICAgIDx0ciBtYXQtcm93ICptYXRSb3dEZWY9XCJsZXQgcm93OyBjb2x1bW5zOiBvZGFwb3NEaXNwbGF5ZWRDb2x1bW5zO1wiIChjbGljayk9XCJzZWxlY3RPZGFwb3NSb3cocm93LCRldmVudClcIiA+PC90cj5cclxuICAgICAgICA8L3RhYmxlPlxyXG5cclxuICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgIDxtYXQtcGFnaW5hdG9yICNvZGFwb3NQYWdpbmF0b3IgW2xlbmd0aF09XCJvZGFwb3NSZXN1bHRzTGVuZ3RoXCIgW3BhZ2VTaXplXT1cIjEwXCIgW3BhZ2VTaXplT3B0aW9uc109XCJbNSwgMTAsIDIwXVwiPjwvbWF0LXBhZ2luYXRvcj5cclxuXHJcbiAgPC9kaXY+XHJcbiAgPGRpdiBtYXQtZGlhbG9nLWFjdGlvbnMgc3R5bGU9XCJmbG9hdDpyaWdodFwiPlxyXG4gICAgPGJ1dHRvbiBtYXQtYnV0dG9uIGNsYXNzPVwic2lpLWJ1dHRvbi1saWdodFwiIFttYXQtZGlhbG9nLWNsb3NlXSBpMThuPVwiQEBzaW9kaWFsb2dfY2FuY2VsX2J1dHRvblwiPkNhbmNlbCBPcGVyYXRpb248L2J1dHRvbj5cclxuICA8L2Rpdj5cclxuIl19